!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):e.firebase=t()}(this,(function(){"use strict";!function(e){if(!e.fetch){var t={searchParams:"URLSearchParams"in e,iterable:"Symbol"in e&&"iterator"in Symbol,blob:"FileReader"in e&&"Blob"in e&&function(){try{return new Blob,!0}catch(e){return!1}}(),formData:"FormData"in e,arrayBuffer:"ArrayBuffer"in e};if(t.arrayBuffer)var o=["[object Int8Array]","[object Uint8Array]","[object Uint8ClampedArray]","[object Int16Array]","[object Uint16Array]","[object Int32Array]","[object Uint32Array]","[object Float32Array]","[object Float64Array]"],i=function(e){return e&&DataView.prototype.isPrototypeOf(e)},r=ArrayBuffer.isView||function(e){return e&&o.indexOf(Object.prototype.toString.call(e))>-1};p.prototype.append=function(e,t){e=a(e),t=c(t);var o=this.map[e];this.map[e]=o?o+","+t:t},p.prototype.delete=function(e){delete this.map[a(e)]},p.prototype.get=function(e){return e=a(e),this.has(e)?this.map[e]:null},p.prototype.has=function(e){return this.map.hasOwnProperty(a(e))},p.prototype.set=function(e,t){this.map[a(e)]=c(t)},p.prototype.forEach=function(e,t){for(var o in this.map)this.map.hasOwnProperty(o)&&e.call(t,this.map[o],o,this)},p.prototype.keys=function(){var e=[];return this.forEach((function(t,o){e.push(o)})),u(e)},p.prototype.values=function(){var e=[];return this.forEach((function(t){e.push(t)})),u(e)},p.prototype.entries=function(){var e=[];return this.forEach((function(t,o){e.push([o,t])})),u(e)},t.iterable&&(p.prototype[Symbol.iterator]=p.prototype.entries);var n=["DELETE","GET","HEAD","OPTIONS","POST","PUT"];b.prototype.clone=function(){return new b(this,{body:this._bodyInit})},m.call(b.prototype),m.call(g.prototype),g.prototype.clone=function(){return new g(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new p(this.headers),url:this.url})},g.error=function(){var e=new g(null,{status:0,statusText:""});return e.type="error",e};var s=[301,302,303,307,308];g.redirect=function(e,t){if(-1===s.indexOf(t))throw new RangeError("Invalid status code");return new g(null,{status:t,headers:{location:e}})},e.Headers=p,e.Request=b,e.Response=g,e.fetch=function(e,o){return new Promise((function(i,r){var n=new b(e,o),s=new XMLHttpRequest;s.onload=function(){var e,t,o={status:s.status,statusText:s.statusText,headers:(e=s.getAllResponseHeaders()||"",t=new p,e.replace(/\r?\n[\t ]+/g," ").split(/\r?\n/).forEach((function(e){var o=e.split(":"),i=o.shift().trim();if(i){var r=o.join(":").trim();t.append(i,r)}})),t)};o.url="responseURL"in s?s.responseURL:o.headers.get("X-Request-URL");var r="response"in s?s.response:s.responseText;i(new g(r,o))},s.onerror=function(){r(new TypeError("Network request failed"))},s.ontimeout=function(){r(new TypeError("Network request failed"))},s.open(n.method,n.url,!0),"include"===n.credentials?s.withCredentials=!0:"omit"===n.credentials&&(s.withCredentials=!1),"responseType"in s&&t.blob&&(s.responseType="blob"),n.headers.forEach((function(e,t){s.setRequestHeader(t,e)})),s.send(void 0===n._bodyInit?null:n._bodyInit)}))},e.fetch.polyfill=!0}function a(e){if("string"!=typeof e&&(e=String(e)),/[^a-z0-9\-#$%&'*+.\^_`|~]/i.test(e))throw new TypeError("Invalid character in header field name");return e.toLowerCase()}function c(e){return"string"!=typeof e&&(e=String(e)),e}function u(e){var o={next:function(){var t=e.shift();return{done:void 0===t,value:t}}};return t.iterable&&(o[Symbol.iterator]=function(){return o}),o}function p(e){this.map={},e instanceof p?e.forEach((function(e,t){this.append(t,e)}),this):Array.isArray(e)?e.forEach((function(e){this.append(e[0],e[1])}),this):e&&Object.getOwnPropertyNames(e).forEach((function(t){this.append(t,e[t])}),this)}function l(e){if(e.bodyUsed)return Promise.reject(new TypeError("Already read"));e.bodyUsed=!0}function d(e){return new Promise((function(t,o){e.onload=function(){t(e.result)},e.onerror=function(){o(e.error)}}))}function h(e){var t=new FileReader,o=d(t);return t.readAsArrayBuffer(e),o}function f(e){if(e.slice)return e.slice(0);var t=new Uint8Array(e.byteLength);return t.set(new Uint8Array(e)),t.buffer}function m(){return this.bodyUsed=!1,this._initBody=function(e){if(this._bodyInit=e,e)if("string"==typeof e)this._bodyText=e;else if(t.blob&&Blob.prototype.isPrototypeOf(e))this._bodyBlob=e;else if(t.formData&&FormData.prototype.isPrototypeOf(e))this._bodyFormData=e;else if(t.searchParams&&URLSearchParams.prototype.isPrototypeOf(e))this._bodyText=e.toString();else if(t.arrayBuffer&&t.blob&&i(e))this._bodyArrayBuffer=f(e.buffer),this._bodyInit=new Blob([this._bodyArrayBuffer]);else{if(!t.arrayBuffer||!ArrayBuffer.prototype.isPrototypeOf(e)&&!r(e))throw new Error("unsupported BodyInit type");this._bodyArrayBuffer=f(e)}else this._bodyText="";this.headers.get("content-type")||("string"==typeof e?this.headers.set("content-type","text/plain;charset=UTF-8"):this._bodyBlob&&this._bodyBlob.type?this.headers.set("content-type",this._bodyBlob.type):t.searchParams&&URLSearchParams.prototype.isPrototypeOf(e)&&this.headers.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"))},t.blob&&(this.blob=function(){var e=l(this);if(e)return e;if(this._bodyBlob)return Promise.resolve(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(new Blob([this._bodyArrayBuffer]));if(this._bodyFormData)throw new Error("could not read FormData body as blob");return Promise.resolve(new Blob([this._bodyText]))},this.arrayBuffer=function(){return this._bodyArrayBuffer?l(this)||Promise.resolve(this._bodyArrayBuffer):this.blob().then(h)}),this.text=function(){var e,t,o,i=l(this);if(i)return i;if(this._bodyBlob)return e=this._bodyBlob,o=d(t=new FileReader),t.readAsText(e),o;if(this._bodyArrayBuffer)return Promise.resolve(function(e){for(var t=new Uint8Array(e),o=new Array(t.length),i=0;i<t.length;i++)o[i]=String.fromCharCode(t[i]);return o.join("")}(this._bodyArrayBuffer));if(this._bodyFormData)throw new Error("could not read FormData body as text");return Promise.resolve(this._bodyText)},t.formData&&(this.formData=function(){return this.text().then(v)}),this.json=function(){return this.text().then(JSON.parse)},this}function b(e,t){var o,i,r=(t=t||{}).body;if(e instanceof b){if(e.bodyUsed)throw new TypeError("Already read");this.url=e.url,this.credentials=e.credentials,t.headers||(this.headers=new p(e.headers)),this.method=e.method,this.mode=e.mode,r||null==e._bodyInit||(r=e._bodyInit,e.bodyUsed=!0)}else this.url=String(e);if(this.credentials=t.credentials||this.credentials||"omit",!t.headers&&this.headers||(this.headers=new p(t.headers)),this.method=(i=(o=t.method||this.method||"GET").toUpperCase(),n.indexOf(i)>-1?i:o),this.mode=t.mode||this.mode||null,this.referrer=null,("GET"===this.method||"HEAD"===this.method)&&r)throw new TypeError("Body not allowed for GET or HEAD requests");this._initBody(r)}function v(e){var t=new FormData;return e.trim().split("&").forEach((function(e){if(e){var o=e.split("="),i=o.shift().replace(/\+/g," "),r=o.join("=").replace(/\+/g," ");t.append(decodeURIComponent(i),decodeURIComponent(r))}})),t}function g(e,t){t||(t={}),this.type="default",this.status=void 0===t.status?200:t.status,this.ok=this.status>=200&&this.status<300,this.statusText="statusText"in t?t.statusText:"OK",this.headers=new p(t.headers),this.url=t.url||"",this._initBody(e)}}("undefined"!=typeof self?self:void 0);var e=setTimeout;function t(){}function o(e){if(!(this instanceof o))throw new TypeError("Promises must be constructed via new");if("function"!=typeof e)throw new TypeError("not a function");this._state=0,this._handled=!1,this._value=void 0,this._deferreds=[],a(e,this)}function i(e,t){for(;3===e._state;)e=e._value;0!==e._state?(e._handled=!0,o._immediateFn((function(){var o=1===e._state?t.onFulfilled:t.onRejected;if(null!==o){var i;try{i=o(e._value)}catch(e){return void n(t.promise,e)}r(t.promise,i)}else(1===e._state?r:n)(t.promise,e._value)}))):e._deferreds.push(t)}function r(e,t){try{if(t===e)throw new TypeError("A promise cannot be resolved with itself.");if(t&&("object"==typeof t||"function"==typeof t)){var i=t.then;if(t instanceof o)return e._state=3,e._value=t,void s(e);if("function"==typeof i)return void a((r=i,c=t,function(){r.apply(c,arguments)}),e)}e._state=1,e._value=t,s(e)}catch(t){n(e,t)}var r,c}function n(e,t){e._state=2,e._value=t,s(e)}function s(e){2===e._state&&0===e._deferreds.length&&o._immediateFn((function(){e._handled||o._unhandledRejectionFn(e._value)}));for(var t=0,r=e._deferreds.length;t<r;t++)i(e,e._deferreds[t]);e._deferreds=null}function a(e,t){var o=!1;try{e((function(e){o||(o=!0,r(t,e))}),(function(e){o||(o=!0,n(t,e))}))}catch(e){if(o)return;o=!0,n(t,e)}}o.prototype.catch=function(e){return this.then(null,e)},o.prototype.then=function(e,o){var r=new this.constructor(t);return i(this,new function(e,t,o){this.onFulfilled="function"==typeof e?e:null,this.onRejected="function"==typeof t?t:null,this.promise=o}(e,o,r)),r},o.prototype.finally=function(e){var t=this.constructor;return this.then((function(o){return t.resolve(e()).then((function(){return o}))}),(function(o){return t.resolve(e()).then((function(){return t.reject(o)}))}))},o.all=function(e){return new o((function(t,o){if(!e||void 0===e.length)throw new TypeError("Promise.all accepts an array");var i=Array.prototype.slice.call(e);if(0===i.length)return t([]);var r=i.length;function n(e,s){try{if(s&&("object"==typeof s||"function"==typeof s)){var a=s.then;if("function"==typeof a)return void a.call(s,(function(t){n(e,t)}),o)}i[e]=s,0==--r&&t(i)}catch(e){o(e)}}for(var s=0;s<i.length;s++)n(s,i[s])}))},o.resolve=function(e){return e&&"object"==typeof e&&e.constructor===o?e:new o((function(t){t(e)}))},o.reject=function(e){return new o((function(t,o){o(e)}))},o.race=function(e){return new o((function(t,o){for(var i=0,r=e.length;i<r;i++)e[i].then(t,o)}))},o._immediateFn="function"==typeof setImmediate&&function(e){setImmediate(e)}||function(t){e(t,0)},o._unhandledRejectionFn=function(e){"undefined"!=typeof console&&console};var c=function(){if("undefined"!=typeof self)return self;if("undefined"!=typeof window)return window;if("undefined"!=typeof global)return global;throw new Error("unable to locate global object")}();function u(e,t){return e(t={exports:{}},t.exports),t.exports}c.Promise||(c.Promise=o);var p=u((function(e){var t=e.exports="undefined"!=typeof window&&window.Math==Math?window:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")();"number"==typeof __g&&(__g=t)})),l=u((function(e){var t=e.exports={version:"2.5.5"};"number"==typeof __e&&(__e=t)})),d=(l.version,function(e){return"object"==typeof e?null!==e:"function"==typeof e}),h=function(e){if(!d(e))throw TypeError(e+" is not an object!");return e},f=function(e){try{return!!e()}catch(e){return!0}},m=!f((function(){return 7!=Object.defineProperty({},"a",{get:function(){return 7}}).a})),b=p.document,v=d(b)&&d(b.createElement),g=!m&&!f((function(){return 7!=Object.defineProperty(("div",v?b.createElement("div"):{}),"a",{get:function(){return 7}}).a})),S=Object.defineProperty,w={f:m?Object.defineProperty:function(e,t,o){if(h(e),t=function(e,t){if(!d(e))return e;var o,i;if("function"==typeof(o=e.toString)&&!d(i=o.call(e)))return i;if("function"==typeof(o=e.valueOf)&&!d(i=o.call(e)))return i;throw TypeError("Can't convert object to primitive value")}(t),h(o),g)try{return S(e,t,o)}catch(e){}if("get"in o||"set"in o)throw TypeError("Accessors not supported!");return"value"in o&&(e[t]=o.value),e}},y=m?function(e,t,o){return w.f(e,t,function(e,t){return{enumerable:!1,configurable:!0,writable:!0,value:t}}(0,o))}:function(e,t,o){return e[t]=o,e},P={}.hasOwnProperty,_=function(e,t){return P.call(e,t)},D=0,E=Math.random(),T=function(e){return"Symbol(".concat(void 0===e?"":e,")_",(++D+E).toString(36))},I=u((function(e){var t=T("src"),o=Function.toString,i=(""+o).split("toString");l.inspectSource=function(e){return o.call(e)},(e.exports=function(e,o,r,n){var s="function"==typeof r;s&&(_(r,"name")||y(r,"name",o)),e[o]!==r&&(s&&(_(r,t)||y(r,t,e[o]?""+e[o]:i.join(String(o)))),e===p?e[o]=r:n?e[o]?e[o]=r:y(e,o,r):(delete e[o],y(e,o,r)))})(Function.prototype,"toString",(function(){return"function"==typeof this&&this[t]||o.call(this)}))})),O=function(e,t,o){if(function(e){if("function"!=typeof e)throw TypeError(e+" is not a function!")}(e),void 0===t)return e;switch(o){case 1:return function(o){return e.call(t,o)};case 2:return function(o,i){return e.call(t,o,i)};case 3:return function(o,i,r){return e.call(t,o,i,r)}}return function(){return e.apply(t,arguments)}},A=function(e,t,o){var i,r,n,s,a=e&A.F,c=e&A.G,u=e&A.S,d=e&A.P,h=e&A.B,f=c?p:u?p[t]||(p[t]={}):(p[t]||{}).prototype,m=c?l:l[t]||(l[t]={}),b=m.prototype||(m.prototype={});for(i in c&&(o=t),o)n=((r=!a&&f&&void 0!==f[i])?f:o)[i],s=h&&r?O(n,p):d&&"function"==typeof n?O(Function.call,n):n,f&&I(f,i,n,e&A.U),m[i]!=n&&y(m,i,s),d&&b[i]!=n&&(b[i]=n)};p.core=l,A.F=1,A.G=2,A.S=4,A.P=8,A.B=16,A.W=32,A.U=64,A.R=128;var N=A,k={}.toString,M=function(e){return k.call(e).slice(8,-1)},C=Object("z").propertyIsEnumerable(0)?Object:function(e){return"String"==M(e)?e.split(""):Object(e)},x=function(e){if(null==e)throw TypeError("Can't call method on  "+e);return e},L=Math.ceil,j=Math.floor,B=Math.min,U=function(e){return e>0?B(function(e){return isNaN(e=+e)?0:(e>0?j:L)(e)}(e),9007199254740991):0},R=Array.isArray||function(e){return"Array"==M(e)},z=p["__core-js_shared__"]||(p["__core-js_shared__"]={}),F=u((function(e){var t=function(e){return z[e]||(z[e]={})}("wks"),o=p.Symbol,i="function"==typeof o;(e.exports=function(e){return t[e]||(t[e]=i&&o[e]||(i?o:T)("Symbol."+e))}).store=t})),V=F("species"),W=function(e,t){return new(function(e){var t;return R(e)&&("function"!=typeof(t=e.constructor)||t!==Array&&!R(t.prototype)||(t=void 0),d(t)&&null===(t=t[V])&&(t=void 0)),void 0===t?Array:t}(e))(t)},H=function(e,t){var o=1==e,i=2==e,r=3==e,n=4==e,s=6==e,a=5==e||s,c=t||W;return function(t,u,p){for(var l,d,h=Object(x(t)),f=C(h),m=O(u,p,3),b=U(f.length),v=0,g=o?c(t,b):i?c(t,0):void 0;b>v;v++)if((a||v in f)&&(d=m(l=f[v],v,h),e))if(o)g[v]=d;else if(d)switch(e){case 3:return!0;case 5:return l;case 6:return v;case 2:g.push(l)}else if(n)return!1;return s?-1:r||n?n:g}},K=F("unscopables"),G=Array.prototype;null==G[K]&&y(G,K,{});var Y=function(e){G[K][e]=!0},Z=H(5),Q=!0;"find"in[]&&Array(1).find((function(){Q=!1})),N(N.P+N.F*Q,"Array",{find:function(e){return Z(this,e,arguments.length>1?arguments[1]:void 0)}}),Y("find"),l.Array.find;var q=H(6),X=!0;"findIndex"in[]&&Array(1).findIndex((function(){X=!1})),N(N.P+N.F*X,"Array",{findIndex:function(e){return q(this,e,arguments.length>1?arguments[1]:void 0)}}),Y("findIndex"),l.Array.findIndex;var J=F("match"),$=function(e,t,o){if(d(i=t)&&(void 0!==(r=i[J])?r:"RegExp"==M(i)))throw TypeError("String#"+o+" doesn't accept regex!");var i,r;return String(x(e))},ee=F("match"),te="".startsWith;N(N.P+N.F*function(e){var t=/./;try{"/./"[e](t)}catch(o){try{return t[ee]=!1,!"/./"[e](t)}catch(e){}}return!0}("startsWith"),"String",{startsWith:function(e){var t=$(this,e,"startsWith"),o=U(Math.min(arguments.length>1?arguments[1]:void 0,t.length)),i=String(e);return te?te.call(t,i,o):t.slice(o,o+i.length)===i}}),l.String.startsWith;var oe=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])};function ie(e,t){if(!(t instanceof Object))return t;switch(t.constructor){case Date:return new Date(t.getTime());case Object:void 0===e&&(e={});break;case Array:e=[];break;default:return t}for(var o in t)t.hasOwnProperty(o)&&(e[o]=ie(e[o],t[o]));return e}function re(e,t,o){e[t]=o}var ne="FirebaseError",se=Error.captureStackTrace,ae=function(e,t){if(this.code=e,this.message=t,se)se(this,ce.prototype.create);else{var o=Error.apply(this,arguments);this.name=ne,Object.defineProperty(this,"stack",{get:function(){return o.stack}})}};ae.prototype=Object.create(Error.prototype),ae.prototype.constructor=ae,ae.prototype.name=ne;var ce=function(){function e(e,t,o){this.service=e,this.serviceName=t,this.errors=o,this.pattern=/\{\$([^}]+)}/g}return e.prototype.create=function(e,t){void 0===t&&(t={});var o,i=this.errors[e],r=this.service+"/"+e;o=void 0===i?"Error":i.replace(this.pattern,(function(e,o){var i=t[o];return void 0!==i?i.toString():"<"+o+"?>"})),o=this.serviceName+": "+o+" ("+r+").";var n=new ae(r,o);for(var s in t)t.hasOwnProperty(s)&&"_"!==s.slice(-1)&&(n[s]=t[s]);return n},e}();function ue(e,t){var o=new pe(e,t);return o.subscribe.bind(o)}!function(e){function t(){var t=e.call(this)||this;t.chain_=[],t.buf_=[],t.W_=[],t.pad_=[],t.inbuf_=0,t.total_=0,t.blockSize=64,t.pad_[0]=128;for(var o=1;o<t.blockSize;++o)t.pad_[o]=0;return t.reset(),t}(function(e,t){function o(){this.constructor=e}oe(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)})(t,e),t.prototype.reset=function(){this.chain_[0]=1732584193,this.chain_[1]=4023233417,this.chain_[2]=2562383102,this.chain_[3]=271733878,this.chain_[4]=3285377520,this.inbuf_=0,this.total_=0},t.prototype.compress_=function(e,t){t||(t=0);var o=this.W_;if("string"==typeof e)for(var i=0;i<16;i++)o[i]=e.charCodeAt(t)<<24|e.charCodeAt(t+1)<<16|e.charCodeAt(t+2)<<8|e.charCodeAt(t+3),t+=4;else for(i=0;i<16;i++)o[i]=e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3],t+=4;for(i=16;i<80;i++){var r=o[i-3]^o[i-8]^o[i-14]^o[i-16];o[i]=4294967295&(r<<1|r>>>31)}var n,s,a=this.chain_[0],c=this.chain_[1],u=this.chain_[2],p=this.chain_[3],l=this.chain_[4];for(i=0;i<80;i++)i<40?i<20?(n=p^c&(u^p),s=1518500249):(n=c^u^p,s=1859775393):i<60?(n=c&u|p&(c|u),s=2400959708):(n=c^u^p,s=3395469782),r=(a<<5|a>>>27)+n+l+s+o[i]&4294967295,l=p,p=u,u=4294967295&(c<<30|c>>>2),c=a,a=r;this.chain_[0]=this.chain_[0]+a&4294967295,this.chain_[1]=this.chain_[1]+c&4294967295,this.chain_[2]=this.chain_[2]+u&4294967295,this.chain_[3]=this.chain_[3]+p&4294967295,this.chain_[4]=this.chain_[4]+l&4294967295},t.prototype.update=function(e,t){if(null!=e){void 0===t&&(t=e.length);for(var o=t-this.blockSize,i=0,r=this.buf_,n=this.inbuf_;i<t;){if(0==n)for(;i<=o;)this.compress_(e,i),i+=this.blockSize;if("string"==typeof e){for(;i<t;)if(r[n]=e.charCodeAt(i),++i,++n==this.blockSize){this.compress_(r),n=0;break}}else for(;i<t;)if(r[n]=e[i],++i,++n==this.blockSize){this.compress_(r),n=0;break}}this.inbuf_=n,this.total_+=t}},t.prototype.digest=function(){var e=[],t=8*this.total_;this.inbuf_<56?this.update(this.pad_,56-this.inbuf_):this.update(this.pad_,this.blockSize-(this.inbuf_-56));for(var o=this.blockSize-1;o>=56;o--)this.buf_[o]=255&t,t/=256;this.compress_(this.buf_);var i=0;for(o=0;o<5;o++)for(var r=24;r>=0;r-=8)e[i]=this.chain_[o]>>r&255,++i;return e}}((function(){this.blockSize=-1}));var pe=function(){function e(e,t){var o=this;this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then((function(){e(o)})).catch((function(e){o.error(e)}))}return e.prototype.next=function(e){this.forEachObserver((function(t){t.next(e)}))},e.prototype.error=function(e){this.forEachObserver((function(t){t.error(e)})),this.close(e)},e.prototype.complete=function(){this.forEachObserver((function(e){e.complete()})),this.close()},e.prototype.subscribe=function(e,t,o){var i,r=this;if(void 0===e&&void 0===t&&void 0===o)throw new Error("Missing Observer.");void 0===(i=function(e,t){if("object"!=typeof e||null===e)return!1;for(var o=0,i=["next","error","complete"];o<i.length;o++){var r=i[o];if(r in e&&"function"==typeof e[r])return!0}return!1}(e)?e:{next:e,error:t,complete:o}).next&&(i.next=le),void 0===i.error&&(i.error=le),void 0===i.complete&&(i.complete=le);var n=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then((function(){try{r.finalError?i.error(r.finalError):i.complete()}catch(e){}})),this.observers.push(i),n},e.prototype.unsubscribeOne=function(e){void 0!==this.observers&&void 0!==this.observers[e]&&(delete this.observers[e],this.observerCount-=1,0===this.observerCount&&void 0!==this.onNoObservers&&this.onNoObservers(this))},e.prototype.forEachObserver=function(e){if(!this.finalized)for(var t=0;t<this.observers.length;t++)this.sendOne(t,e)},e.prototype.sendOne=function(e,t){var o=this;this.task.then((function(){if(void 0!==o.observers&&void 0!==o.observers[e])try{t(o.observers[e])}catch(e){"undefined"!=typeof console&&console.error}}))},e.prototype.close=function(e){var t=this;this.finalized||(this.finalized=!0,void 0!==e&&(this.finalError=e),this.task.then((function(){t.observers=void 0,t.onNoObservers=void 0})))},e}();function le(){}var de=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},he="[DEFAULT]",fe=[],me=function(){function e(e,t,o){this.firebase_=o,this.isDeleted_=!1,this.services_={},this.name_=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled||!1,this.options_=ie(void 0,e),this.INTERNAL={getUid:function(){return null},getToken:function(){return Promise.resolve(null)},addAuthTokenListener:function(e){fe.push(e),setTimeout((function(){return e(null)}),0)},removeAuthTokenListener:function(e){fe=fe.filter((function(t){return t!==e}))}}}return Object.defineProperty(e.prototype,"automaticDataCollectionEnabled",{get:function(){return this.checkDestroyed_(),this._automaticDataCollectionEnabled},set:function(e){this.checkDestroyed_(),this._automaticDataCollectionEnabled=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"name",{get:function(){return this.checkDestroyed_(),this.name_},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"options",{get:function(){return this.checkDestroyed_(),this.options_},enumerable:!0,configurable:!0}),e.prototype.delete=function(){var e=this;return new Promise((function(t){e.checkDestroyed_(),t()})).then((function(){e.firebase_.INTERNAL.removeApp(e.name_);var t=[];return Object.keys(e.services_).forEach((function(o){Object.keys(e.services_[o]).forEach((function(i){t.push(e.services_[o][i])}))})),Promise.all(t.map((function(e){return e.INTERNAL.delete()})))})).then((function(){e.isDeleted_=!0,e.services_={}}))},e.prototype._getService=function(e,t){if(void 0===t&&(t=he),this.checkDestroyed_(),this.services_[e]||(this.services_[e]={}),!this.services_[e][t]){var o=t!==he?t:void 0,i=this.firebase_.INTERNAL.factories[e](this,this.extendApp.bind(this),o);this.services_[e][t]=i}return this.services_[e][t]},e.prototype.extendApp=function(e){var t=this;ie(this,e),e.INTERNAL&&e.INTERNAL.addAuthTokenListener&&(fe.forEach((function(e){t.INTERNAL.addAuthTokenListener(e)})),fe=[])},e.prototype.checkDestroyed_=function(){this.isDeleted_&&be("app-deleted",{name:this.name_})},e}();function be(e,t){throw ve.create(e,t)}me.prototype.name&&me.prototype.options||me.prototype.delete;var ve=new ce("app","Firebase",{"no-app":"No Firebase App '{$name}' has been created - call Firebase App.initializeApp()","bad-app-name":"Illegal App name: '{$name}","duplicate-app":"Firebase App named '{$name}' already exists","app-deleted":"Firebase App named '{$name}' already deleted","duplicate-service":"Firebase service named '{$name}' already registered","sa-not-supported":"Initializing the Firebase SDK with a service account is only allowed in a Node.js environment. On client devices, you should instead initialize the SDK with an api key and auth domain","invalid-app-argument":"firebase.{$name}() takes either no argument or a Firebase App instance."}),ge=function e(){var t={},o={},i={},r={__esModule:!0,initializeApp:function(e,o){(void 0===o&&(o={}),"object"!=typeof o||null===o)&&(o={name:o});var i=o;void 0===i.name&&(i.name=he);var n=i.name;"string"==typeof n&&n||be("bad-app-name",{name:n+""}),de(t,n)&&be("duplicate-app",{name:n});var s=new me(e,i,r);return t[n]=s,a(s,"create"),s},app:n,apps:null,Promise:Promise,SDK_VERSION:"4.13.0",INTERNAL:{registerService:function(e,t,a,c,u){o[e]&&be("duplicate-service",{name:e}),o[e]=t,c&&(i[e]=c,s().forEach((function(e){c("create",e)})));var p=function(t){return void 0===t&&(t=n()),"function"!=typeof t[e]&&be("invalid-app-argument",{name:e}),t[e]()};return void 0!==a&&ie(p,a),r[e]=p,me.prototype[e]=function(){for(var t=[],o=0;o<arguments.length;o++)t[o]=arguments[o];return this._getService.bind(this,e).apply(this,u?t:[])},p},createFirebaseNamespace:e,extendNamespace:function(e){ie(r,e)},createSubscribe:ue,ErrorFactory:ce,removeApp:function(e){a(t[e],"delete"),delete t[e]},factories:o,useAsService:c,Promise:Promise,deepExtend:ie}};function n(e){return de(t,e=e||he)||be("no-app",{name:e}),t[e]}function s(){return Object.keys(t).map((function(e){return t[e]}))}function a(e,t){Object.keys(o).forEach((function(o){var r=c(e,o);null!==r&&i[r]&&i[r](t,e)}))}function c(e,t){if("serverAuth"===t)return null;var o=t;return e.options,o}return re(r,"default",r),Object.defineProperty(r,"apps",{get:s}),re(n,"App",me),r}(),Se=Object.freeze({default:ge,firebase:ge});return(Se&&ge||Se).default})),function(e,t){"use strict";try{t=t&&t.hasOwnProperty("default")?t.default:t;var o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])};function i(e,t){function i(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}var r=Object.assign||function(e){for(var t,o=1,i=arguments.length;o<i;o++)for(var r in t=arguments[o])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e};function n(e,t,o,i){return new(o||(o=Promise))((function(r,n){function s(e){try{c(i.next(e))}catch(e){n(e)}}function a(e){try{c(i.throw(e))}catch(e){n(e)}}function c(e){e.done?r(e.value):new o((function(t){t(e.value)})).then(s,a)}c((i=i.apply(e,t||[])).next())}))}function s(e,t){var o,i,r,n,s={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return n={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(n[Symbol.iterator]=function(){return this}),n;function a(n){return function(a){return function(n){if(o)throw new TypeError("Generator is already executing.");for(;s;)try{if(o=1,i&&(r=i[2&n[0]?"return":n[0]?"throw":"next"])&&!(r=r.call(i,n[1])).done)return r;switch(i=0,r&&(n=[0,r.value]),n[0]){case 0:case 1:r=n;break;case 4:return s.label++,{value:n[1],done:!1};case 5:s.label++,i=n[1],n=[0];continue;case 7:n=s.ops.pop(),s.trys.pop();continue;default:if(!(r=(r=s.trys).length>0&&r[r.length-1])&&(6===n[0]||2===n[0])){s=0;continue}if(3===n[0]&&(!r||n[1]>r[0]&&n[1]<r[3])){s.label=n[1];break}if(6===n[0]&&s.label<r[1]){s.label=r[1],r=n;break}if(r&&s.label<r[2]){s.label=r[2],s.ops.push(n);break}r[2]&&s.ops.pop(),s.trys.pop();continue}n=t.call(e,s)}catch(e){n=[6,e],i=0}finally{o=r=0}if(5&n[0])throw n[1];return{value:n[0]?n[1]:void 0,done:!0}}([n,a])}}}var a="FirebaseError",c=Error.captureStackTrace,u=function(e,t){if(this.code=e,this.message=t,c)c(this,p.prototype.create);else{var o=Error.apply(this,arguments);this.name=a,Object.defineProperty(this,"stack",{get:function(){return o.stack}})}};u.prototype=Object.create(Error.prototype),u.prototype.constructor=u,u.prototype.name=a;var p=function(){function e(e,t,o){this.service=e,this.serviceName=t,this.errors=o,this.pattern=/\{\$([^}]+)}/g}return e.prototype.create=function(e,t){void 0===t&&(t={});var o,i=this.errors[e],r=this.service+"/"+e;o=void 0===i?"Error":i.replace(this.pattern,(function(e,o){var i=t[o];return void 0!==i?i.toString():"<"+o+"?>"})),o=this.serviceName+": "+o+" ("+r+").";var n=new u(r,o);for(var s in t)t.hasOwnProperty(s)&&"_"!==s.slice(-1)&&(n[s]=t[s]);return n},e}();function l(e,t){var o=new d(e,t);return o.subscribe.bind(o)}!function(e){function t(){var t=e.call(this)||this;t.chain_=[],t.buf_=[],t.W_=[],t.pad_=[],t.inbuf_=0,t.total_=0,t.blockSize=64,t.pad_[0]=128;for(var o=1;o<t.blockSize;++o)t.pad_[o]=0;return t.reset(),t}i(t,e),t.prototype.reset=function(){this.chain_[0]=1732584193,this.chain_[1]=4023233417,this.chain_[2]=2562383102,this.chain_[3]=271733878,this.chain_[4]=3285377520,this.inbuf_=0,this.total_=0},t.prototype.compress_=function(e,t){t||(t=0);var o=this.W_;if("string"==typeof e)for(var i=0;i<16;i++)o[i]=e.charCodeAt(t)<<24|e.charCodeAt(t+1)<<16|e.charCodeAt(t+2)<<8|e.charCodeAt(t+3),t+=4;else for(i=0;i<16;i++)o[i]=e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3],t+=4;for(i=16;i<80;i++){var r=o[i-3]^o[i-8]^o[i-14]^o[i-16];o[i]=4294967295&(r<<1|r>>>31)}var n,s,a=this.chain_[0],c=this.chain_[1],u=this.chain_[2],p=this.chain_[3],l=this.chain_[4];for(i=0;i<80;i++)i<40?i<20?(n=p^c&(u^p),s=1518500249):(n=c^u^p,s=1859775393):i<60?(n=c&u|p&(c|u),s=2400959708):(n=c^u^p,s=3395469782),r=(a<<5|a>>>27)+n+l+s+o[i]&4294967295,l=p,p=u,u=4294967295&(c<<30|c>>>2),c=a,a=r;this.chain_[0]=this.chain_[0]+a&4294967295,this.chain_[1]=this.chain_[1]+c&4294967295,this.chain_[2]=this.chain_[2]+u&4294967295,this.chain_[3]=this.chain_[3]+p&4294967295,this.chain_[4]=this.chain_[4]+l&4294967295},t.prototype.update=function(e,t){if(null!=e){void 0===t&&(t=e.length);for(var o=t-this.blockSize,i=0,r=this.buf_,n=this.inbuf_;i<t;){if(0==n)for(;i<=o;)this.compress_(e,i),i+=this.blockSize;if("string"==typeof e){for(;i<t;)if(r[n]=e.charCodeAt(i),++i,++n==this.blockSize){this.compress_(r),n=0;break}}else for(;i<t;)if(r[n]=e[i],++i,++n==this.blockSize){this.compress_(r),n=0;break}}this.inbuf_=n,this.total_+=t}},t.prototype.digest=function(){var e=[],t=8*this.total_;this.inbuf_<56?this.update(this.pad_,56-this.inbuf_):this.update(this.pad_,this.blockSize-(this.inbuf_-56));for(var o=this.blockSize-1;o>=56;o--)this.buf_[o]=255&t,t/=256;this.compress_(this.buf_);var i=0;for(o=0;o<5;o++)for(var r=24;r>=0;r-=8)e[i]=this.chain_[o]>>r&255,++i;return e}}((function(){this.blockSize=-1}));var d=function(){function e(e,t){var o=this;this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then((function(){e(o)})).catch((function(e){o.error(e)}))}return e.prototype.next=function(e){this.forEachObserver((function(t){t.next(e)}))},e.prototype.error=function(e){this.forEachObserver((function(t){t.error(e)})),this.close(e)},e.prototype.complete=function(){this.forEachObserver((function(e){e.complete()})),this.close()},e.prototype.subscribe=function(e,t,o){var i,r=this;if(void 0===e&&void 0===t&&void 0===o)throw new Error("Missing Observer.");void 0===(i=function(e,t){if("object"!=typeof e||null===e)return!1;for(var o=0,i=["next","error","complete"];o<i.length;o++){var r=i[o];if(r in e&&"function"==typeof e[r])return!0}return!1}(e)?e:{next:e,error:t,complete:o}).next&&(i.next=h),void 0===i.error&&(i.error=h),void 0===i.complete&&(i.complete=h);var n=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then((function(){try{r.finalError?i.error(r.finalError):i.complete()}catch(e){}})),this.observers.push(i),n},e.prototype.unsubscribeOne=function(e){void 0!==this.observers&&void 0!==this.observers[e]&&(delete this.observers[e],this.observerCount-=1,0===this.observerCount&&void 0!==this.onNoObservers&&this.onNoObservers(this))},e.prototype.forEachObserver=function(e){if(!this.finalized)for(var t=0;t<this.observers.length;t++)this.sendOne(t,e)},e.prototype.sendOne=function(e,t){var o=this;this.task.then((function(){if(void 0!==o.observers&&void 0!==o.observers[e])try{t(o.observers[e])}catch(e){"undefined"!=typeof console&&console.error}}))},e.prototype.close=function(e){var t=this;this.finalized||(this.finalized=!0,void 0!==e&&(this.finalError=e),this.task.then((function(){t.observers=void 0,t.onNoObservers=void 0})))},e}();function h(){}var f,m,b,v={AVAILABLE_IN_WINDOW:"only-available-in-window",AVAILABLE_IN_SW:"only-available-in-sw",SHOULD_BE_INHERITED:"should-be-overriden",BAD_SENDER_ID:"bad-sender-id",INCORRECT_GCM_SENDER_ID:"incorrect-gcm-sender-id",PERMISSION_DEFAULT:"permission-default",PERMISSION_BLOCKED:"permission-blocked",UNSUPPORTED_BROWSER:"unsupported-browser",NOTIFICATIONS_BLOCKED:"notifications-blocked",FAILED_DEFAULT_REGISTRATION:"failed-serviceworker-registration",SW_REGISTRATION_EXPECTED:"sw-registration-expected",GET_SUBSCRIPTION_FAILED:"get-subscription-failed",INVALID_SAVED_TOKEN:"invalid-saved-token",SW_REG_REDUNDANT:"sw-reg-redundant",TOKEN_SUBSCRIBE_FAILED:"token-subscribe-failed",TOKEN_SUBSCRIBE_NO_TOKEN:"token-subscribe-no-token",TOKEN_SUBSCRIBE_NO_PUSH_SET:"token-subscribe-no-push-set",TOKEN_UNSUBSCRIBE_FAILED:"token-unsubscribe-failed",TOKEN_UPDATE_FAILED:"token-update-failed",TOKEN_UPDATE_NO_TOKEN:"token-update-no-token",USE_SW_BEFORE_GET_TOKEN:"use-sw-before-get-token",INVALID_DELETE_TOKEN:"invalid-delete-token",DELETE_TOKEN_NOT_FOUND:"delete-token-not-found",DELETE_SCOPE_NOT_FOUND:"delete-scope-not-found",BG_HANDLER_FUNCTION_EXPECTED:"bg-handler-function-expected",NO_WINDOW_CLIENT_TO_MSG:"no-window-client-to-msg",UNABLE_TO_RESUBSCRIBE:"unable-to-resubscribe",NO_FCM_TOKEN_FOR_RESUBSCRIBE:"no-fcm-token-for-resubscribe",FAILED_TO_DELETE_TOKEN:"failed-to-delete-token",NO_SW_IN_REG:"no-sw-in-reg",BAD_SCOPE:"bad-scope",BAD_VAPID_KEY:"bad-vapid-key",BAD_SUBSCRIPTION:"bad-subscription",BAD_TOKEN:"bad-token",BAD_PUSH_SET:"bad-push-set",FAILED_DELETE_VAPID_KEY:"failed-delete-vapid-key",INVALID_PUBLIC_VAPID_KEY:"invalid-public-vapid-key",USE_PUBLIC_KEY_BEFORE_GET_TOKEN:"use-public-key-before-get-token",PUBLIC_KEY_DECRYPTION_FAILED:"public-vapid-key-decryption-failed"},g=((f={})[v.AVAILABLE_IN_WINDOW]="This method is available in a Window context.",f[v.AVAILABLE_IN_SW]="This method is available in a service worker context.",f[v.SHOULD_BE_INHERITED]="This method should be overriden by extended classes.",f[v.BAD_SENDER_ID]="Please ensure that 'messagingSenderId' is set correctly in the options passed into firebase.initializeApp().",f[v.PERMISSION_DEFAULT]="The required permissions were not granted and dismissed instead.",f[v.PERMISSION_BLOCKED]="The required permissions were not granted and blocked instead.",f[v.UNSUPPORTED_BROWSER]="This browser doesn't support the API's required to use the firebase SDK.",f[v.NOTIFICATIONS_BLOCKED]="Notifications have been blocked.",f[v.FAILED_DEFAULT_REGISTRATION]="We are unable to register the default service worker. {$browserErrorMessage}",f[v.SW_REGISTRATION_EXPECTED]="A service worker registration was the expected input.",f[v.GET_SUBSCRIPTION_FAILED]="There was an error when trying to get any existing Push Subscriptions.",f[v.INVALID_SAVED_TOKEN]="Unable to access details of the saved token.",f[v.SW_REG_REDUNDANT]="The service worker being used for push was made redundant.",f[v.TOKEN_SUBSCRIBE_FAILED]="A problem occured while subscribing the user to FCM: {$message}",f[v.TOKEN_SUBSCRIBE_NO_TOKEN]="FCM returned no token when subscribing the user to push.",f[v.TOKEN_SUBSCRIBE_NO_PUSH_SET]="FCM returned an invalid response when getting an FCM token.",f[v.TOKEN_UNSUBSCRIBE_FAILED]="A problem occured while unsubscribing the user from FCM: {$message}",f[v.TOKEN_UPDATE_FAILED]="A problem occured while updating the user from FCM: {$message}",f[v.TOKEN_UPDATE_NO_TOKEN]="FCM returned no token when updating the user to push.",f[v.USE_SW_BEFORE_GET_TOKEN]="The useServiceWorker() method may only be called once and must be called before calling getToken() to ensure your service worker is used.",f[v.INVALID_DELETE_TOKEN]="You must pass a valid token into deleteToken(), i.e. the token from getToken().",f[v.DELETE_TOKEN_NOT_FOUND]="The deletion attempt for token could not be performed as the token was not found.",f[v.DELETE_SCOPE_NOT_FOUND]="The deletion attempt for service worker scope could not be performed as the scope was not found.",f[v.BG_HANDLER_FUNCTION_EXPECTED]="The input to setBackgroundMessageHandler() must be a function.",f[v.NO_WINDOW_CLIENT_TO_MSG]="An attempt was made to message a non-existant window client.",f[v.UNABLE_TO_RESUBSCRIBE]="There was an error while re-subscribing the FCM token for push messaging. Will have to resubscribe the user on next visit. {$message}",f[v.NO_FCM_TOKEN_FOR_RESUBSCRIBE]="Could not find an FCM token and as a result, unable to resubscribe. Will have to resubscribe the user on next visit.",f[v.FAILED_TO_DELETE_TOKEN]="Unable to delete the currently saved token.",f[v.NO_SW_IN_REG]="Even though the service worker registration was successful, there was a problem accessing the service worker itself.",f[v.INCORRECT_GCM_SENDER_ID]="Please change your web app manifest's 'gcm_sender_id' value to '103953800507' to use Firebase messaging.",f[v.BAD_SCOPE]="The service worker scope must be a string with at least one character.",f[v.BAD_VAPID_KEY]="The public VAPID key is not a Uint8Array with 65 bytes.",f[v.BAD_SUBSCRIPTION]="The subscription must be a valid PushSubscription.",f[v.BAD_TOKEN]="The FCM Token used for storage / lookup was not a valid token string.",f[v.BAD_PUSH_SET]="The FCM push set used for storage / lookup was not not a valid push set string.",f[v.FAILED_DELETE_VAPID_KEY]="The VAPID key could not be deleted.",f[v.INVALID_PUBLIC_VAPID_KEY]="The public VAPID key must be a string.",f[v.PUBLIC_KEY_DECRYPTION_FAILED]="The public VAPID key did not equal 65 bytes when decrypted.",f),S=new p("messaging","Messaging",g),w=new Uint8Array([4,51,148,247,223,161,235,177,220,3,162,94,21,113,219,72,211,46,237,237,178,52,219,183,71,58,12,143,196,204,225,111,60,140,132,223,171,182,102,62,242,12,212,139,254,227,249,118,47,20,28,99,8,106,111,45,177,26,149,176,206,55,192,156,110]),y="https://fcm.googleapis.com";function P(e,t){if(null==e||null==t)return!1;if(e===t)return!0;if(e.byteLength!==t.byteLength)return!1;for(var o=new DataView(e),i=new DataView(t),r=0;r<e.byteLength;r++)if(o.getUint8(r)!==i.getUint8(r))return!1;return!0}function _(e){return function(e){var t=new Uint8Array(e);return btoa(String.fromCharCode.apply(null,t))}(e).replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")}!function(e){e.TYPE_OF_MSG="firebase-messaging-msg-type",e.DATA="firebase-messaging-msg-data"}(m||(m={})),function(e){e.PUSH_MSG_RECEIVED="push-msg-received",e.NOTIFICATION_CLICKED="notification-clicked"}(b||(b={}));var D=function(){function e(){}return e.prototype.getToken=function(e,t,o){return n(this,void 0,void 0,(function(){var i,r,n,a,c,u,p,l;return s(this,(function(s){switch(s.label){case 0:i=_(t.getKey("p256dh")),r=_(t.getKey("auth")),n="authorized_entity="+e+"&endpoint="+t.endpoint+"&encryption_key="+i+"&encryption_auth="+r,o!==w&&(a=_(o),n+="&application_pub_key="+a),(c=new Headers).append("Content-Type","application/x-www-form-urlencoded"),u={method:"POST",headers:c,body:n},s.label=1;case 1:return s.trys.push([1,4,,5]),[4,fetch(y+"/fcm/connect/subscribe",u)];case 2:return[4,s.sent().json()];case 3:return p=s.sent(),[3,5];case 4:throw s.sent(),S.create(v.TOKEN_SUBSCRIBE_FAILED);case 5:if(p.error)throw l=p.error.message,S.create(v.TOKEN_SUBSCRIBE_FAILED,{message:l});if(!p.token)throw S.create(v.TOKEN_SUBSCRIBE_NO_TOKEN);if(!p.pushSet)throw S.create(v.TOKEN_SUBSCRIBE_NO_PUSH_SET);return[2,{token:p.token,pushSet:p.pushSet}]}}))}))},e.prototype.updateToken=function(e,t,o,i,r){return n(this,void 0,void 0,(function(){var n,a,c,u,p,l,d,h;return s(this,(function(s){switch(s.label){case 0:n=_(i.getKey("p256dh")),a=_(i.getKey("auth")),c="push_set="+o+"&token="+t+"&authorized_entity="+e+"&endpoint="+i.endpoint+"&encryption_key="+n+"&encryption_auth="+a,r!==w&&(u=_(r),c+="&application_pub_key="+u),(p=new Headers).append("Content-Type","application/x-www-form-urlencoded"),l={method:"POST",headers:p,body:c},s.label=1;case 1:return s.trys.push([1,4,,5]),[4,fetch(y+"/fcm/connect/subscribe",l)];case 2:return[4,s.sent().json()];case 3:return d=s.sent(),[3,5];case 4:throw s.sent(),S.create(v.TOKEN_UPDATE_FAILED);case 5:if(d.error)throw h=d.error.message,S.create(v.TOKEN_UPDATE_FAILED,{message:h});if(!d.token)throw S.create(v.TOKEN_UPDATE_NO_TOKEN);return[2,d.token]}}))}))},e.prototype.deleteToken=function(e,t,o){return n(this,void 0,void 0,(function(){var i,r,n,a,c;return s(this,(function(s){switch(s.label){case 0:i="authorized_entity="+e+"&token="+t+"&pushSet="+o,(r=new Headers).append("Content-Type","application/x-www-form-urlencoded"),n={method:"POST",headers:r,body:i},s.label=1;case 1:return s.trys.push([1,4,,5]),[4,fetch(y+"/fcm/connect/unsubscribe",n)];case 2:return[4,s.sent().json()];case 3:if((a=s.sent()).error)throw c=a.error.message,S.create(v.TOKEN_UNSUBSCRIBE_FAILED,{message:c});return[3,5];case 4:throw s.sent(),S.create(v.TOKEN_UNSUBSCRIBE_FAILED);case 5:return[2]}}))}))},e}();function E(e){for(var t=(e+"=".repeat((4-e.length%4)%4)).replace(/\-/g,"+").replace(/_/g,"/"),o=window.atob(t),i=new Uint8Array(o.length),r=0;r<o.length;++r)i[r]=o.charCodeAt(r);return i}var T="undefined",I="fcm_token_object_Store";var O=function(){function e(){this.dbPromise=null}return e.prototype.get=function(e){return this.createTransaction((function(t){return t.get(e)}))},e.prototype.getIndex=function(e,t){return this.createTransaction((function(o){return o.index(e).get(t)}))},e.prototype.put=function(e){return this.createTransaction((function(t){return t.put(e)}),"readwrite")},e.prototype.delete=function(e){return this.createTransaction((function(t){return t.delete(e)}),"readwrite")},e.prototype.closeDatabase=function(){return n(this,void 0,void 0,(function(){return s(this,(function(e){switch(e.label){case 0:return this.dbPromise?[4,this.dbPromise]:[3,2];case 1:e.sent().close(),this.dbPromise=null,e.label=2;case 2:return[2]}}))}))},e.prototype.createTransaction=function(e,t){return n(this,void 0,void 0,(function(){var o,i,r,n;return s(this,(function(s){switch(s.label){case 0:return[4,this.getDb()];case 1:return o=s.sent(),i=o.transaction(this.objectStoreName,t),r=i.objectStore(this.objectStoreName),[4,function(e){return new Promise((function(t,o){e.onsuccess=function(){t(e.result)},e.onerror=function(){o(e.error)}}))}(e(r))];case 2:return n=s.sent(),[2,new Promise((function(e,t){i.oncomplete=function(){e(n)},i.onerror=function(){t(i.error)}}))]}}))}))},e.prototype.getDb=function(){var e=this;return this.dbPromise||(this.dbPromise=new Promise((function(t,o){var i=indexedDB.open(e.dbName,e.dbVersion);i.onsuccess=function(){t(i.result)},i.onerror=function(){e.dbPromise=null,o(i.error)},i.onupgradeneeded=function(t){return e.onDbUpgrade(i,t)}}))),this.dbPromise},e}(),A=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.dbName="fcm_token_details_db",t.dbVersion=3,t.objectStoreName="fcm_token_object_Store",t}return i(t,e),t.prototype.onDbUpgrade=function(e,t){var o=e.result;switch(t.oldVersion){case 0:(i=o.createObjectStore(this.objectStoreName,{keyPath:"swScope"})).createIndex("fcmSenderId","fcmSenderId",{unique:!1}),i.createIndex("fcmToken","fcmToken",{unique:!0});case 1:!function(){var e=indexedDB.open(T);e.onerror=function(e){},e.onsuccess=function(t){!function(e){if(e.objectStoreNames.contains(I)){var t=e.transaction(I).objectStore(I),o=new D,i=t.openCursor();i.onerror=function(e){},i.onsuccess=function(){var t=i.result;if(t){var r=t.value;o.deleteToken(r.fcmSenderId,r.fcmToken,r.fcmPushSet),t.continue()}else e.close(),indexedDB.deleteDatabase(T)}}}(e.result)}}();case 2:var i,n=(i=e.transaction.objectStore(this.objectStoreName)).openCursor();n.onsuccess=function(){var e=n.result;if(e){var t=e.value,o=r({},t);t.createTime||(o.createTime=Date.now()),"string"==typeof t.vapidKey&&(o.vapidKey=E(t.vapidKey)),"string"==typeof t.auth&&(o.auth=E(t.auth).buffer),"string"==typeof t.auth&&(o.p256dh=E(t.p256dh).buffer),e.update(o),e.continue()}}}},t.prototype.getTokenDetailsFromToken=function(e){return n(this,void 0,void 0,(function(){return s(this,(function(t){if(!e)throw S.create(v.BAD_TOKEN);return N({fcmToken:e}),[2,this.getIndex("fcmToken",e)]}))}))},t.prototype.getTokenDetailsFromSWScope=function(e){return n(this,void 0,void 0,(function(){return s(this,(function(t){if(!e)throw S.create(v.BAD_SCOPE);return N({swScope:e}),[2,this.get(e)]}))}))},t.prototype.saveTokenDetails=function(e){return n(this,void 0,void 0,(function(){return s(this,(function(t){if(!e.swScope)throw S.create(v.BAD_SCOPE);if(!e.vapidKey)throw S.create(v.BAD_VAPID_KEY);if(!e.endpoint||!e.auth||!e.p256dh)throw S.create(v.BAD_SUBSCRIPTION);if(!e.fcmSenderId)throw S.create(v.BAD_SENDER_ID);if(!e.fcmToken)throw S.create(v.BAD_TOKEN);if(!e.fcmPushSet)throw S.create(v.BAD_PUSH_SET);return N(e),[2,this.put(e)]}))}))},t.prototype.deleteToken=function(e){return n(this,void 0,void 0,(function(){var t;return s(this,(function(o){switch(o.label){case 0:return"string"!=typeof e||0===e.length?[2,Promise.reject(S.create(v.INVALID_DELETE_TOKEN))]:[4,this.getTokenDetailsFromToken(e)];case 1:if(!(t=o.sent()))throw S.create(v.DELETE_TOKEN_NOT_FOUND);return[4,this.delete(t.swScope)];case 2:return o.sent(),[2,t]}}))}))},t}(O);function N(e){if(e.fcmToken&&("string"!=typeof e.fcmToken||0===e.fcmToken.length))throw S.create(v.BAD_TOKEN);if(e.swScope&&("string"!=typeof e.swScope||0===e.swScope.length))throw S.create(v.BAD_SCOPE);if(e.vapidKey&&(!(e.vapidKey instanceof Uint8Array)||65!==e.vapidKey.length))throw S.create(v.BAD_VAPID_KEY);if(e.endpoint&&("string"!=typeof e.endpoint||0===e.endpoint.length))throw S.create(v.BAD_SUBSCRIPTION);if(e.auth&&!(e.auth instanceof ArrayBuffer))throw S.create(v.BAD_SUBSCRIPTION);if(e.p256dh&&!(e.p256dh instanceof ArrayBuffer))throw S.create(v.BAD_SUBSCRIPTION);if(e.fcmSenderId&&("string"!=typeof e.fcmSenderId||0===e.fcmSenderId.length))throw S.create(v.BAD_SENDER_ID);if(e.fcmPushSet&&("string"!=typeof e.fcmPushSet||0===e.fcmPushSet.length))throw S.create(v.BAD_PUSH_SET)}var k=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.dbName="fcm_vapid_details_db",t.dbVersion=1,t.objectStoreName="fcm_vapid_object_Store",t}return i(t,e),t.prototype.onDbUpgrade=function(e){e.result.createObjectStore(this.objectStoreName,{keyPath:"swScope"})},t.prototype.getVapidFromSWScope=function(e){return n(this,void 0,void 0,(function(){var t;return s(this,(function(o){switch(o.label){case 0:if("string"!=typeof e||0===e.length)throw S.create(v.BAD_SCOPE);return[4,this.get(e)];case 1:return[2,(t=o.sent())?t.vapidKey:void 0]}}))}))},t.prototype.saveVapidDetails=function(e,t){return n(this,void 0,void 0,(function(){var o;return s(this,(function(i){if("string"!=typeof e||0===e.length)throw S.create(v.BAD_SCOPE);if(null===t||65!==t.length)throw S.create(v.BAD_VAPID_KEY);return o={swScope:e,vapidKey:t},[2,this.put(o)]}))}))},t.prototype.deleteVapidDetails=function(e){return n(this,void 0,void 0,(function(){var t;return s(this,(function(o){switch(o.label){case 0:return[4,this.getVapidFromSWScope(e)];case 1:if(!(t=o.sent()))throw S.create(v.DELETE_SCOPE_NOT_FOUND);return[4,this.delete(e)];case 2:return o.sent(),[2,t]}}))}))},t}(O),M="messagingSenderId",C=function(){function e(e){var t=this;if(!e.options[M]||"string"!=typeof e.options[M])throw S.create(v.BAD_SENDER_ID);this.messagingSenderId=e.options[M],this.tokenDetailsModel=new A,this.vapidDetailsModel=new k,this.iidModel=new D,this.app=e,this.INTERNAL={delete:function(){return t.delete()}}}return e.prototype.getToken=function(){return n(this,void 0,void 0,(function(){var e,t,o,i,r;return s(this,(function(n){switch(n.label){case 0:return"granted"!==(e=this.getNotificationPermission_())?"denied"===e?[2,Promise.reject(S.create(v.NOTIFICATIONS_BLOCKED))]:[2,Promise.resolve(null)]:[4,this.getSWRegistration_()];case 1:return t=n.sent(),[4,this.getPublicVapidKey_()];case 2:return o=n.sent(),[4,this.getPushSubscription(t,o)];case 3:return i=n.sent(),[4,this.tokenDetailsModel.getTokenDetailsFromSWScope(t.scope)];case 4:return(r=n.sent())?[2,this.manageExistingToken(t,i,o,r)]:[2,this.getNewToken(t,i,o)]}}))}))},e.prototype.manageExistingToken=function(e,t,o,i){return n(this,void 0,void 0,(function(){return s(this,(function(r){switch(r.label){case 0:return function(e,t,o){if(!P(t.buffer,o.vapidKey.buffer))return!1;var i=e.endpoint===o.endpoint,r=P(e.getKey("auth"),o.auth),n=P(e.getKey("p256dh"),o.p256dh);return i&&r&&n}(t,o,i)?Date.now()<i.createTime+6048e5?[2,i.fcmToken]:[2,this.updateToken(e,t,o,i)]:[4,this.deleteTokenFromDB(i.fcmToken)];case 1:return r.sent(),[2,this.getNewToken(e,t,o)]}}))}))},e.prototype.updateToken=function(e,t,o,i){return n(this,void 0,void 0,(function(){var r,n,a;return s(this,(function(s){switch(s.label){case 0:return s.trys.push([0,4,,6]),[4,this.iidModel.updateToken(this.messagingSenderId,i.fcmToken,i.fcmPushSet,t,o)];case 1:return r=s.sent(),n={swScope:e.scope,vapidKey:o,fcmSenderId:this.messagingSenderId,fcmToken:r,fcmPushSet:i.fcmPushSet,createTime:Date.now(),endpoint:t.endpoint,auth:t.getKey("auth"),p256dh:t.getKey("p256dh")},[4,this.tokenDetailsModel.saveTokenDetails(n)];case 2:return s.sent(),[4,this.vapidDetailsModel.saveVapidDetails(e.scope,o)];case 3:return s.sent(),[2,r];case 4:return a=s.sent(),[4,this.deleteToken(i.fcmToken)];case 5:throw s.sent(),a;case 6:return[2]}}))}))},e.prototype.getNewToken=function(e,t,o){return n(this,void 0,void 0,(function(){var i,r;return s(this,(function(n){switch(n.label){case 0:return[4,this.iidModel.getToken(this.messagingSenderId,t,o)];case 1:return i=n.sent(),r={swScope:e.scope,vapidKey:o,fcmSenderId:this.messagingSenderId,fcmToken:i.token,fcmPushSet:i.pushSet,createTime:Date.now(),endpoint:t.endpoint,auth:t.getKey("auth"),p256dh:t.getKey("p256dh")},[4,this.tokenDetailsModel.saveTokenDetails(r)];case 2:return n.sent(),[4,this.vapidDetailsModel.saveVapidDetails(e.scope,o)];case 3:return n.sent(),[2,i.token]}}))}))},e.prototype.deleteToken=function(e){return n(this,void 0,void 0,(function(){var t,o;return s(this,(function(i){switch(i.label){case 0:return[4,this.deleteTokenFromDB(e)];case 1:return i.sent(),[4,this.getSWRegistration_()];case 2:return(t=i.sent())?[4,t.pushManager.getSubscription()]:[3,4];case 3:if(o=i.sent())return[2,o.unsubscribe()];i.label=4;case 4:return[2,!0]}}))}))},e.prototype.deleteTokenFromDB=function(e){return n(this,void 0,void 0,(function(){var t;return s(this,(function(o){switch(o.label){case 0:return[4,this.tokenDetailsModel.deleteToken(e)];case 1:return t=o.sent(),[4,this.iidModel.deleteToken(t.fcmSenderId,t.fcmToken,t.fcmPushSet)];case 2:return o.sent(),[2]}}))}))},e.prototype.getPushSubscription=function(e,t){return e.pushManager.getSubscription().then((function(o){return o||e.pushManager.subscribe({userVisibleOnly:!0,applicationServerKey:t})}))},e.prototype.requestPermission=function(){throw S.create(v.AVAILABLE_IN_WINDOW)},e.prototype.useServiceWorker=function(e){throw S.create(v.AVAILABLE_IN_WINDOW)},e.prototype.usePublicVapidKey=function(e){throw S.create(v.AVAILABLE_IN_WINDOW)},e.prototype.onMessage=function(e,t,o){throw S.create(v.AVAILABLE_IN_WINDOW)},e.prototype.onTokenRefresh=function(e,t,o){throw S.create(v.AVAILABLE_IN_WINDOW)},e.prototype.setBackgroundMessageHandler=function(e){throw S.create(v.AVAILABLE_IN_SW)},e.prototype.delete=function(){return n(this,void 0,void 0,(function(){return s(this,(function(e){switch(e.label){case 0:return[4,Promise.all([this.tokenDetailsModel.closeDatabase(),this.vapidDetailsModel.closeDatabase()])];case 1:return e.sent(),[2]}}))}))},e.prototype.getNotificationPermission_=function(){return Notification.permission},e.prototype.getTokenDetailsModel=function(){return this.tokenDetailsModel},e.prototype.getVapidDetailsModel=function(){return this.vapidDetailsModel},e.prototype.getIIDModel=function(){return this.iidModel},e}(),x=function(e){function t(t){var o=e.call(this,t)||this;return o.bgMessageHandler=null,self.addEventListener("push",(function(e){o.onPush(e)})),self.addEventListener("pushsubscriptionchange",(function(e){o.onSubChange(e)})),self.addEventListener("notificationclick",(function(e){o.onNotificationClick(e)})),o}return i(t,e),t.prototype.onPush=function(e){e.waitUntil(this.onPush_(e))},t.prototype.onSubChange=function(e){e.waitUntil(this.onSubChange_(e))},t.prototype.onNotificationClick=function(e){e.waitUntil(this.onNotificationClick_(e))},t.prototype.onPush_=function(e){return n(this,void 0,void 0,(function(){var t,o,i;return s(this,(function(r){switch(r.label){case 0:if(!e.data)return[2];try{t=e.data.json()}catch(e){return[2]}return[4,this.hasVisibleClients_()];case 1:return r.sent()?t.notification||this.bgMessageHandler?[2,this.sendMessageToWindowClients_(t)]:[2]:(o=this.getNotificationData_(t))?(i=o.title||"",[4,this.getSWRegistration_()]):[3,3];case 2:return[2,r.sent().showNotification(i,o)];case 3:return this.bgMessageHandler?[4,this.bgMessageHandler(t)]:[3,5];case 4:return r.sent(),[2];case 5:return[2]}}))}))},t.prototype.onSubChange_=function(e){return n(this,void 0,void 0,(function(){var e,t,o,i;return s(this,(function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),[4,this.getSWRegistration_()];case 1:return e=r.sent(),[3,3];case 2:throw t=r.sent(),S.create(v.UNABLE_TO_RESUBSCRIBE,{message:t});case 3:return r.trys.push([3,5,,8]),[4,e.pushManager.getSubscription()];case 4:return r.sent(),[3,8];case 5:return o=r.sent(),[4,this.getTokenDetailsModel().getTokenDetailsFromSWScope(e.scope)];case 6:if(!(i=r.sent()))throw o;return[4,this.deleteToken(i.fcmToken)];case 7:throw r.sent(),o;case 8:return[2]}}))}))},t.prototype.onNotificationClick_=function(e){return n(this,void 0,void 0,(function(){var t,o,i,r;return s(this,(function(n){switch(n.label){case 0:return e.notification&&e.notification.data&&e.notification.data.FCM_MSG?(e.stopImmediatePropagation(),e.notification.close(),(t=e.notification.data.FCM_MSG).notification&&(o=t.notification.click_action)?[4,this.getWindowClient_(o)]:[2]):[2];case 1:return(i=n.sent())?[3,3]:[4,self.clients.openWindow(o)];case 2:return i=n.sent(),[3,5];case 3:return[4,i.focus()];case 4:i=n.sent(),n.label=5;case 5:return i?(delete t.notification,r=j(b.NOTIFICATION_CLICKED,t),[2,this.attemptToMessageClient_(i,r)]):[2]}}))}))},t.prototype.getNotificationData_=function(e){if(e&&"object"==typeof e.notification){var t,o=r({},e.notification);return o.data=((t={}).FCM_MSG=e,t),o}},t.prototype.setBackgroundMessageHandler=function(e){if(!e||"function"!=typeof e)throw S.create(v.BG_HANDLER_FUNCTION_EXPECTED);this.bgMessageHandler=e},t.prototype.getWindowClient_=function(e){return n(this,void 0,void 0,(function(){var t,o,i,r;return s(this,(function(n){switch(n.label){case 0:return t=new URL(e,self.location.href).href,[4,L()];case 1:for(o=n.sent(),i=null,r=0;r<o.length;r++)if(new URL(o[r].url,self.location.href).href===t){i=o[r];break}return[2,i]}}))}))},t.prototype.attemptToMessageClient_=function(e,t){return n(this,void 0,void 0,(function(){return s(this,(function(o){if(!e)throw S.create(v.NO_WINDOW_CLIENT_TO_MSG);return e.postMessage(t),[2]}))}))},t.prototype.hasVisibleClients_=function(){return n(this,void 0,void 0,(function(){return s(this,(function(e){switch(e.label){case 0:return[4,L()];case 1:return[2,e.sent().some((function(e){return"visible"===e.visibilityState}))]}}))}))},t.prototype.sendMessageToWindowClients_=function(e){return n(this,void 0,void 0,(function(){var t,o,i=this;return s(this,(function(r){switch(r.label){case 0:return[4,L()];case 1:return t=r.sent(),o=j(b.PUSH_MSG_RECEIVED,e),[4,Promise.all(t.map((function(e){return i.attemptToMessageClient_(e,o)})))];case 2:return r.sent(),[2]}}))}))},t.prototype.getSWRegistration_=function(){return n(this,void 0,void 0,(function(){return s(this,(function(e){return[2,self.registration]}))}))},t.prototype.getPublicVapidKey_=function(){return n(this,void 0,void 0,(function(){var e,t;return s(this,(function(o){switch(o.label){case 0:return[4,this.getSWRegistration_()];case 1:if(!(e=o.sent()))throw S.create(v.SW_REGISTRATION_EXPECTED);return[4,this.getVapidDetailsModel().getVapidFromSWScope(e.scope)];case 2:return null==(t=o.sent())?[2,w]:[2,t]}}))}))},t}(C);function L(){return self.clients.matchAll({type:"window",includeUncontrolled:!0})}function j(e,t){return(o={})[m.TYPE_OF_MSG]=e,o[m.DATA]=t,o;var o}var B=function(e){function t(t){var o=e.call(this,t)||this;return o.registrationToUse=null,o.publicVapidKeyToUse=null,o.manifestCheckPromise=null,o.messageObserver=null,o.tokenRefreshObserver=null,o.onMessageInternal=l((function(e){o.messageObserver=e})),o.onTokenRefreshInternal=l((function(e){o.tokenRefreshObserver=e})),o.setupSWMessageListener_(),o}return i(t,e),t.prototype.getToken=function(){var t=this;return this.isSupported_()?this.manifestCheck_().then((function(){return e.prototype.getToken.call(t)})):Promise.reject(S.create(v.UNSUPPORTED_BROWSER))},t.prototype.manifestCheck_=function(){if(this.manifestCheckPromise)return this.manifestCheckPromise;var e=document.querySelector('link[rel="manifest"]');return this.manifestCheckPromise=e?fetch(e.href).then((function(e){return e.json()})).catch((function(){})).then((function(e){if(e&&e.gcm_sender_id&&"103953800507"!==e.gcm_sender_id)throw S.create(v.INCORRECT_GCM_SENDER_ID)})):Promise.resolve(),this.manifestCheckPromise},t.prototype.requestPermission=function(){return n(this,void 0,void 0,(function(){return s(this,(function(e){return"granted"===Notification.permission?[2]:[2,new Promise((function(e,t){var o=function(o){return"granted"===o?e():t("denied"===o?S.create(v.PERMISSION_BLOCKED):S.create(v.PERMISSION_DEFAULT))},i=Notification.requestPermission(o);i&&i.then(o)}))]}))}))},t.prototype.useServiceWorker=function(e){if(!(e instanceof ServiceWorkerRegistration))throw S.create(v.SW_REGISTRATION_EXPECTED);if(null!=this.registrationToUse)throw S.create(v.USE_SW_BEFORE_GET_TOKEN);this.registrationToUse=e},t.prototype.usePublicVapidKey=function(e){if("string"!=typeof e)throw S.create(v.INVALID_PUBLIC_VAPID_KEY);if(null!=this.publicVapidKeyToUse)throw S.create(v.USE_PUBLIC_KEY_BEFORE_GET_TOKEN);var t=E(e);if(65!==t.length)throw S.create(v.PUBLIC_KEY_DECRYPTION_FAILED);this.publicVapidKeyToUse=t},t.prototype.onMessage=function(e,t,o){return"function"==typeof e?this.onMessageInternal(e,t,o):this.onMessageInternal(e)},t.prototype.onTokenRefresh=function(e,t,o){return"function"==typeof e?this.onTokenRefreshInternal(e,t,o):this.onTokenRefreshInternal(e)},t.prototype.waitForRegistrationToActivate_=function(e){var t=e.installing||e.waiting||e.active;return new Promise((function(o,i){if(t)if("activated"!==t.state)if("redundant"!==t.state){var r=function(){if("activated"===t.state)o(e);else{if("redundant"!==t.state)return;i(S.create(v.SW_REG_REDUNDANT))}t.removeEventListener("statechange",r)};t.addEventListener("statechange",r)}else i(S.create(v.SW_REG_REDUNDANT));else o(e);else i(S.create(v.NO_SW_IN_REG))}))},t.prototype.getSWRegistration_=function(){var e=this;return this.registrationToUse?this.waitForRegistrationToActivate_(this.registrationToUse):(this.registrationToUse=null,navigator.serviceWorker.register("/sp-push-worker-fb.js",{scope:"/sendpulse-fb-messaging-push-scope"}).catch((function(e){throw S.create(v.FAILED_DEFAULT_REGISTRATION,{browserErrorMessage:e.message})})).then((function(t){return e.waitForRegistrationToActivate_(t).then((function(){return e.registrationToUse=t,t.update(),t}))})))},t.prototype.getPublicVapidKey_=function(){return this.publicVapidKeyToUse?Promise.resolve(this.publicVapidKeyToUse):Promise.resolve(w)},t.prototype.setupSWMessageListener_=function(){var e=this;"serviceWorker"in navigator&&navigator.serviceWorker.addEventListener("message",(function(t){if(t.data&&t.data[m.TYPE_OF_MSG]){var o=t.data;switch(o[m.TYPE_OF_MSG]){case b.PUSH_MSG_RECEIVED:case b.NOTIFICATION_CLICKED:var i=o[m.DATA];e.messageObserver&&e.messageObserver.next(i)}}}),!1)},t.prototype.isSupported_=function(){return"serviceWorker"in navigator&&"PushManager"in window&&"Notification"in window&&"fetch"in window&&ServiceWorkerRegistration.prototype.hasOwnProperty("showNotification")&&PushSubscription.prototype.hasOwnProperty("getKey")},t}(C);return U={Messaging:B},t.INTERNAL.registerService("messaging",(function(e){return self&&"ServiceWorkerGlobalScope"in self?new x(e):new B(e)}),U),{}}catch(e){throw new Error("Cannot instantiate firebase-messaging - be sure to load firebase-app.js first.")}var U}(this.firebase=this.firebase||{},firebase),function(e,t){"use strict";var o="function",i="object",r="model",n="name",s="type",a="vendor",c="version",u="architecture",p="console",l="mobile",d="tablet",h="smarttv",f="wearable",m={extend:function(e,t){var o={};for(var i in e)t[i]&&t[i].length%2==0?o[i]=t[i].concat(e[i]):o[i]=e[i];return o},has:function(e,t){return"string"==typeof e&&-1!==t.toLowerCase().indexOf(e.toLowerCase())},lowerize:function(e){return e.toLowerCase()},major:function(e){return"string"==typeof e?e.replace(/[^\d\.]/g,"").split(".")[0]:t},trim:function(e){return e.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"")}},b={rgx:function(e,r){for(var n,s,a,c,u,p,l=0;l<r.length&&!u;){var d=r[l],h=r[l+1];for(n=s=0;n<d.length&&!u;)if(u=d[n++].exec(e))for(a=0;a<h.length;a++)p=u[++s],typeof(c=h[a])==i&&0<c.length?2==c.length?typeof c[1]==o?this[c[0]]=c[1].call(this,p):this[c[0]]=c[1]:3==c.length?typeof c[1]!=o||c[1].exec&&c[1].test?this[c[0]]=p?p.replace(c[1],c[2]):t:this[c[0]]=p?c[1].call(this,p,c[2]):t:4==c.length&&(this[c[0]]=p?c[3].call(this,p.replace(c[1],c[2])):t):this[c]=p||t;l+=2}},str:function(e,o){for(var r in o)if(typeof o[r]==i&&0<o[r].length){for(var n=0;n<o[r].length;n++)if(m.has(o[r][n],e))return"?"===r?t:r}else if(m.has(o[r],e))return"?"===r?t:r;return e}},v={browser:{oldsafari:{version:{"1.0":"/8",1.2:"/1",1.3:"/3","2.0":"/412","2.0.2":"/416","2.0.3":"/417","2.0.4":"/419","?":"/"}}},device:{amazon:{model:{"Fire Phone":["SD","KF"]}},sprint:{model:{"Evo Shift 4G":"7373KT"},vendor:{HTC:"APA",Sprint:"Sprint"}}},os:{windows:{version:{ME:"4.90","NT 3.11":"NT3.51","NT 4.0":"NT4.0",2e3:"NT 5.0",XP:["NT 5.1","NT 5.2"],Vista:"NT 6.0",7:"NT 6.1",8:"NT 6.2",8.1:"NT 6.3",10:["NT 6.4","NT 10.0"],RT:"ARM"}}}},g={browser:[[/(opera\smini)\/([\w\.-]+)/i,/(opera\s[mobiletab]+).+version\/([\w\.-]+)/i,/(opera).+version\/([\w\.]+)/i,/(opera)[\/\s]+([\w\.]+)/i],[n,c],[/(opios)[\/\s]+([\w\.]+)/i],[[n,"Opera Mini"],c],[/\s(opr)\/([\w\.]+)/i],[[n,"Opera"],c],[/(kindle)\/([\w\.]+)/i,/(lunascape|maxthon|netfront|jasmine|blazer)[\/\s]?([\w\.]*)/i,/(avant\s|iemobile|slim|baidu)(?:browser)?[\/\s]?([\w\.]*)/i,/(?:ms|\()(ie)\s([\w\.]+)/i,/(rekonq)\/([\w\.]*)/i,/(chromium|flock|rockmelt|midori|epiphany|silk|skyfire|ovibrowser|bolt|iron|vivaldi|iridium|phantomjs|bowser|quark)\/([\w\.-]+)/i],[n,c],[/(trident).+rv[:\s]([\w\.]+).+like\sgecko/i],[[n,"IE"],c],[/(edge|edgios|edgea)\/((\d+)?[\w\.]+)/i],[[n,"Edge"],c],[/(yabrowser)\/([\w\.]+)/i],[[n,"Yandex"],c],[/(puffin)\/([\w\.]+)/i],[[n,"Puffin"],c],[/((?:[\s\/])uc?\s?browser|(?:juc.+)ucweb)[\/\s]?([\w\.]+)/i],[[n,"UCBrowser"],c],[/(comodo_dragon)\/([\w\.]+)/i],[[n,/_/g," "],c],[/(micromessenger)\/([\w\.]+)/i],[[n,"WeChat"],c],[/(qqbrowserlite)\/([\w\.]+)/i],[n,c],[/(QQ)\/([\d\.]+)/i],[n,c],[/m?(qqbrowser)[\/\s]?([\w\.]+)/i],[n,c],[/(BIDUBrowser)[\/\s]?([\w\.]+)/i],[n,c],[/(2345Explorer)[\/\s]?([\w\.]+)/i],[n,c],[/(MetaSr)[\/\s]?([\w\.]+)/i],[n],[/(LBBROWSER)/i],[n],[/xiaomi\/miuibrowser\/([\w\.]+)/i],[c,[n,"MIUI Browser"]],[/;fbav\/([\w\.]+);/i],[c,[n,"Facebook"]],[/safari\s(line)\/([\w\.]+)/i,/android.+(line)\/([\w\.]+)\/iab/i],[n,c],[/headlesschrome(?:\/([\w\.]+)|\s)/i],[c,[n,"Chrome Headless"]],[/\swv\).+(chrome)\/([\w\.]+)/i],[[n,/(.+)/,"$1 WebView"],c],[/((?:oculus|samsung)browser)\/([\w\.]+)/i],[[n,/(.+(?:g|us))(.+)/,"$1 $2"],c],[/android.+version\/([\w\.]+)\s+(?:mobile\s?safari|safari)*/i],[c,[n,"Android Browser"]],[/(chrome|omniweb|arora|[tizenoka]{5}\s?browser)\/v?([\w\.]+)/i],[n,c],[/(dolfin)\/([\w\.]+)/i],[[n,"Dolphin"],c],[/((?:android.+)crmo|crios)\/([\w\.]+)/i],[[n,"Chrome"],c],[/(coast)\/([\w\.]+)/i],[[n,"Opera Coast"],c],[/fxios\/([\w\.-]+)/i],[c,[n,"Firefox"]],[/version\/([\w\.]+).+?mobile\/\w+\s(safari)/i],[c,[n,"Mobile Safari"]],[/version\/([\w\.]+).+?(mobile\s?safari|safari)/i],[c,n],[/webkit.+?(gsa)\/([\w\.]+).+?(mobile\s?safari|safari)(\/[\w\.]+)/i],[[n,"GSA"],c],[/webkit.+?(mobile\s?safari|safari)(\/[\w\.]+)/i],[n,[c,b.str,v.browser.oldsafari.version]],[/(konqueror)\/([\w\.]+)/i,/(webkit|khtml)\/([\w\.]+)/i],[n,c],[/(navigator|netscape)\/([\w\.-]+)/i],[[n,"Netscape"],c],[/(swiftfox)/i,/(icedragon|iceweasel|camino|chimera|fennec|maemo\sbrowser|minimo|conkeror)[\/\s]?([\w\.\+]+)/i,/(firefox|seamonkey|k-meleon|icecat|iceape|firebird|phoenix|palemoon|basilisk|waterfox)\/([\w\.-]+)$/i,/(mozilla)\/([\w\.]+).+rv\:.+gecko\/\d+/i,/(polaris|lynx|dillo|icab|doris|amaya|w3m|netsurf|sleipnir)[\/\s]?([\w\.]+)/i,/(links)\s\(([\w\.]+)/i,/(gobrowser)\/?([\w\.]*)/i,/(ice\s?browser)\/v?([\w\._]+)/i,/(mosaic)[\/\s]([\w\.]+)/i],[n,c]],cpu:[[/(?:(amd|x(?:(?:86|64)[_-])?|wow|win)64)[;\)]/i],[[u,"amd64"]],[/(ia32(?=;))/i],[[u,m.lowerize]],[/((?:i[346]|x)86)[;\)]/i],[[u,"ia32"]],[/windows\s(ce|mobile);\sppc;/i],[[u,"arm"]],[/((?:ppc|powerpc)(?:64)?)(?:\smac|;|\))/i],[[u,/ower/,"",m.lowerize]],[/(sun4\w)[;\)]/i],[[u,"sparc"]],[/((?:avr32|ia64(?=;))|68k(?=\))|arm(?:64|(?=v\d+[;l]))|(?=atmel\s)avr|(?:irix|mips|sparc)(?:64)?(?=;)|pa-risc)/i],[[u,m.lowerize]]],device:[[/\((ipad|playbook);[\w\s\);-]+(rim|apple)/i],[r,a,[s,d]],[/applecoremedia\/[\w\.]+ \((ipad)/],[r,[a,"Apple"],[s,d]],[/(apple\s{0,1}tv)/i],[[r,"Apple TV"],[a,"Apple"]],[/(archos)\s(gamepad2?)/i,/(hp).+(touchpad)/i,/(hp).+(tablet)/i,/(kindle)\/([\w\.]+)/i,/\s(nook)[\w\s]+build\/(\w+)/i,/(dell)\s(strea[kpr\s\d]*[\dko])/i],[a,r,[s,d]],[/(kf[A-z]+)\sbuild\/.+silk\//i],[r,[a,"Amazon"],[s,d]],[/(sd|kf)[0349hijorstuw]+\sbuild\/.+silk\//i],[[r,b.str,v.device.amazon.model],[a,"Amazon"],[s,l]],[/android.+aft([bms])\sbuild/i],[r,[a,"Amazon"],[s,h]],[/\((ip[honed|\s\w*]+);.+(apple)/i],[r,a,[s,l]],[/\((ip[honed|\s\w*]+);/i],[r,[a,"Apple"],[s,l]],[/(blackberry)[\s-]?(\w+)/i,/(blackberry|benq|palm(?=\-)|sonyericsson|acer|asus|dell|meizu|motorola|polytron)[\s_-]?([\w-]*)/i,/(hp)\s([\w\s]+\w)/i,/(asus)-?(\w+)/i],[a,r,[s,l]],[/\(bb10;\s(\w+)/i],[r,[a,"BlackBerry"],[s,l]],[/android.+(transfo[prime\s]{4,10}\s\w+|eeepc|slider\s\w+|nexus 7|padfone)/i],[r,[a,"Asus"],[s,d]],[/(sony)\s(tablet\s[ps])\sbuild\//i,/(sony)?(?:sgp.+)\sbuild\//i],[[a,"Sony"],[r,"Xperia Tablet"],[s,d]],[/android.+\s([c-g]\d{4}|so[-l]\w+)\sbuild\//i],[r,[a,"Sony"],[s,l]],[/\s(ouya)\s/i,/(nintendo)\s([wids3u]+)/i],[a,r,[s,p]],[/android.+;\s(shield)\sbuild/i],[r,[a,"Nvidia"],[s,p]],[/(playstation\s[34portablevi]+)/i],[r,[a,"Sony"],[s,p]],[/(sprint\s(\w+))/i],[[a,b.str,v.device.sprint.vendor],[r,b.str,v.device.sprint.model],[s,l]],[/(lenovo)\s?(S(?:5000|6000)+(?:[-][\w+]))/i],[a,r,[s,d]],[/(htc)[;_\s-]+([\w\s]+(?=\))|\w+)*/i,/(zte)-(\w*)/i,/(alcatel|geeksphone|lenovo|nexian|panasonic|(?=;\s)sony)[_\s-]?([\w-]*)/i],[a,[r,/_/g," "],[s,l]],[/(nexus\s9)/i],[r,[a,"HTC"],[s,d]],[/d\/huawei([\w\s-]+)[;\)]/i,/(nexus\s6p)/i],[r,[a,"Huawei"],[s,l]],[/(microsoft);\s(lumia[\s\w]+)/i],[a,r,[s,l]],[/[\s\(;](xbox(?:\sone)?)[\s\);]/i],[r,[a,"Microsoft"],[s,p]],[/(kin\.[onetw]{3})/i],[[r,/\./g," "],[a,"Microsoft"],[s,l]],[/\s(milestone|droid(?:[2-4x]|\s(?:bionic|x2|pro|razr))?:?(\s4g)?)[\w\s]+build\//i,/mot[\s-]?(\w*)/i,/(XT\d{3,4}) build\//i,/(nexus\s6)/i],[r,[a,"Motorola"],[s,l]],[/android.+\s(mz60\d|xoom[\s2]{0,2})\sbuild\//i],[r,[a,"Motorola"],[s,d]],[/hbbtv\/\d+\.\d+\.\d+\s+\([\w\s]*;\s*(\w[^;]*);([^;]*)/i],[[a,m.trim],[r,m.trim],[s,h]],[/hbbtv.+maple;(\d+)/i],[[r,/^/,"SmartTV"],[a,"Samsung"],[s,h]],[/\(dtv[\);].+(aquos)/i],[r,[a,"Sharp"],[s,h]],[/android.+((sch-i[89]0\d|shw-m380s|gt-p\d{4}|gt-n\d+|sgh-t8[56]9|nexus 10))/i,/((SM-T\w+))/i],[[a,"Samsung"],r,[s,d]],[/smart-tv.+(samsung)/i],[a,[s,h],r],[/((s[cgp]h-\w+|gt-\w+|galaxy\snexus|sm-\w[\w\d]+))/i,/(sam[sung]*)[\s-]*(\w+-?[\w-]*)/i,/sec-((sgh\w+))/i],[[a,"Samsung"],r,[s,l]],[/sie-(\w*)/i],[r,[a,"Siemens"],[s,l]],[/(maemo|nokia).*(n900|lumia\s\d+)/i,/(nokia)[\s_-]?([\w-]*)/i],[[a,"Nokia"],r,[s,l]],[/android\s3\.[\s\w;-]{10}(a\d{3})/i],[r,[a,"Acer"],[s,d]],[/android.+([vl]k\-?\d{3})\s+build/i],[r,[a,"LG"],[s,d]],[/android\s3\.[\s\w;-]{10}(lg?)-([06cv9]{3,4})/i],[[a,"LG"],r,[s,d]],[/(lg) netcast\.tv/i],[a,r,[s,h]],[/(nexus\s[45])/i,/lg[e;\s\/-]+(\w*)/i,/android.+lg(\-?[\d\w]+)\s+build/i],[r,[a,"LG"],[s,l]],[/android.+(ideatab[a-z0-9\-\s]+)/i],[r,[a,"Lenovo"],[s,d]],[/linux;.+((jolla));/i],[a,r,[s,l]],[/((pebble))app\/[\d\.]+\s/i],[a,r,[s,f]],[/android.+;\s(oppo)\s?([\w\s]+)\sbuild/i],[a,r,[s,l]],[/crkey/i],[[r,"Chromecast"],[a,"Google"]],[/android.+;\s(glass)\s\d/i],[r,[a,"Google"],[s,f]],[/android.+;\s(pixel c)\s/i],[r,[a,"Google"],[s,d]],[/android.+;\s(pixel [xl2]{1,2}|pixel)\s/i],[r,[a,"Google"],[s,l]],[/android.+;\s(\w+)\s+build\/hm\1/i,/android.+(hm[\s\-_]*note?[\s_]*(?:\d\w)?)\s+build/i,/android.+(mi[\s\-_]*(?:one|one[\s_]plus|note lte)?[\s_]*(?:\d?\w?)[\s_]*(?:plus)?)\s+build/i,/android.+(redmi[\s\-_]*(?:note)?(?:[\s_]*[\w\s]+))\s+build/i],[[r,/_/g," "],[a,"Xiaomi"],[s,l]],[/android.+(mi[\s\-_]*(?:pad)(?:[\s_]*[\w\s]+))\s+build/i],[[r,/_/g," "],[a,"Xiaomi"],[s,d]],[/android.+;\s(m[1-5]\snote)\sbuild/i],[r,[a,"Meizu"],[s,d]],[/android.+a000(1)\s+build/i,/android.+oneplus\s(a\d{4})\s+build/i],[r,[a,"OnePlus"],[s,l]],[/android.+[;\/]\s*(RCT[\d\w]+)\s+build/i],[r,[a,"RCA"],[s,d]],[/android.+[;\/\s]+(Venue[\d\s]{2,7})\s+build/i],[r,[a,"Dell"],[s,d]],[/android.+[;\/]\s*(Q[T|M][\d\w]+)\s+build/i],[r,[a,"Verizon"],[s,d]],[/android.+[;\/]\s+(Barnes[&\s]+Noble\s+|BN[RT])(V?.*)\s+build/i],[[a,"Barnes & Noble"],r,[s,d]],[/android.+[;\/]\s+(TM\d{3}.*\b)\s+build/i],[r,[a,"NuVision"],[s,d]],[/android.+;\s(k88)\sbuild/i],[r,[a,"ZTE"],[s,d]],[/android.+[;\/]\s*(gen\d{3})\s+build.*49h/i],[r,[a,"Swiss"],[s,l]],[/android.+[;\/]\s*(zur\d{3})\s+build/i],[r,[a,"Swiss"],[s,d]],[/android.+[;\/]\s*((Zeki)?TB.*\b)\s+build/i],[r,[a,"Zeki"],[s,d]],[/(android).+[;\/]\s+([YR]\d{2})\s+build/i,/android.+[;\/]\s+(Dragon[\-\s]+Touch\s+|DT)(\w{5})\sbuild/i],[[a,"Dragon Touch"],r,[s,d]],[/android.+[;\/]\s*(NS-?\w{0,9})\sbuild/i],[r,[a,"Insignia"],[s,d]],[/android.+[;\/]\s*((NX|Next)-?\w{0,9})\s+build/i],[r,[a,"NextBook"],[s,d]],[/android.+[;\/]\s*(Xtreme\_)?(V(1[045]|2[015]|30|40|60|7[05]|90))\s+build/i],[[a,"Voice"],r,[s,l]],[/android.+[;\/]\s*(LVTEL\-)?(V1[12])\s+build/i],[[a,"LvTel"],r,[s,l]],[/android.+[;\/]\s*(V(100MD|700NA|7011|917G).*\b)\s+build/i],[r,[a,"Envizen"],[s,d]],[/android.+[;\/]\s*(Le[\s\-]+Pan)[\s\-]+(\w{1,9})\s+build/i],[a,r,[s,d]],[/android.+[;\/]\s*(Trio[\s\-]*.*)\s+build/i],[r,[a,"MachSpeed"],[s,d]],[/android.+[;\/]\s*(Trinity)[\-\s]*(T\d{3})\s+build/i],[a,r,[s,d]],[/android.+[;\/]\s*TU_(1491)\s+build/i],[r,[a,"Rotor"],[s,d]],[/android.+(KS(.+))\s+build/i],[r,[a,"Amazon"],[s,d]],[/android.+(Gigaset)[\s\-]+(Q\w{1,9})\s+build/i],[a,r,[s,d]],[/\s(tablet|tab)[;\/]/i,/\s(mobile)(?:[;\/]|\ssafari)/i],[[s,m.lowerize],a,r],[/(android[\w\.\s\-]{0,9});.+build/i],[r,[a,"Generic"]]],engine:[[/windows.+\sedge\/([\w\.]+)/i],[c,[n,"EdgeHTML"]],[/(presto)\/([\w\.]+)/i,/(webkit|trident|netfront|netsurf|amaya|lynx|w3m)\/([\w\.]+)/i,/(khtml|tasman|links)[\/\s]\(?([\w\.]+)/i,/(icab)[\/\s]([23]\.[\d\.]+)/i],[n,c],[/rv\:([\w\.]{1,9}).+(gecko)/i],[c,n]],os:[[/microsoft\s(windows)\s(vista|xp)/i],[n,c],[/(windows)\snt\s6\.2;\s(arm)/i,/(windows\sphone(?:\sos)*)[\s\/]?([\d\.\s\w]*)/i,/(windows\smobile|windows)[\s\/]?([ntce\d\.\s]+\w)/i],[n,[c,b.str,v.os.windows.version]],[/(win(?=3|9|n)|win\s9x\s)([nt\d\.]+)/i],[[n,"Windows"],[c,b.str,v.os.windows.version]],[/\((bb)(10);/i],[[n,"BlackBerry"],c],[/(blackberry)\w*\/?([\w\.]*)/i,/(tizen)[\/\s]([\w\.]+)/i,/(android|webos|palm\sos|qnx|bada|rim\stablet\sos|meego|contiki)[\/\s-]?([\w\.]*)/i,/linux;.+(sailfish);/i],[n,c],[/(symbian\s?os|symbos|s60(?=;))[\/\s-]?([\w\.]*)/i],[[n,"Symbian"],c],[/\((series40);/i],[n],[/mozilla.+\(mobile;.+gecko.+firefox/i],[[n,"Firefox OS"],c],[/(nintendo|playstation)\s([wids34portablevu]+)/i,/(mint)[\/\s\(]?(\w*)/i,/(mageia|vectorlinux)[;\s]/i,/(joli|[kxln]?ubuntu|debian|suse|opensuse|gentoo|(?=\s)arch|slackware|fedora|mandriva|centos|pclinuxos|redhat|zenwalk|linpus)[\/\s-]?(?!chrom)([\w\.-]*)/i,/(hurd|linux)\s?([\w\.]*)/i,/(gnu)\s?([\w\.]*)/i],[n,c],[/(cros)\s[\w]+\s([\w\.]+\w)/i],[[n,"Chromium OS"],c],[/(sunos)\s?([\w\.\d]*)/i],[[n,"Solaris"],c],[/\s([frentopc-]{0,4}bsd|dragonfly)\s?([\w\.]*)/i],[n,c],[/(haiku)\s(\w+)/i],[n,c],[/cfnetwork\/.+darwin/i,/ip[honead]{2,4}(?:.*os\s([\w]+)\slike\smac|;\sopera)/i],[[c,/_/g,"."],[n,"iOS"]],[/(mac\sos\sx)\s?([\w\s\.]*)/i,/(macintosh|mac(?=_powerpc)\s)/i],[[n,"Mac OS"],[c,/_/g,"."]],[/((?:open)?solaris)[\/\s-]?([\w\.]*)/i,/(aix)\s((\d)(?=\.|\)|\s)[\w\.])*/i,/(plan\s9|minix|beos|os\/2|amigaos|morphos|risc\sos|openvms)/i,/(unix)\s?([\w\.]*)/i],[n,c]]},S=function(o,i){if("object"==typeof o&&(i=o,o=t),!(this instanceof S))return new S(o,i).getResult();var r=o||(e&&e.navigator&&e.navigator.userAgent?e.navigator.userAgent:""),n=i?m.extend(g,i):g;return this.getBrowser=function(){var e={name:t,version:t};return b.rgx.call(e,r,n.browser),e.major=m.major(e.version),e},this.getCPU=function(){var e={architecture:t};return b.rgx.call(e,r,n.cpu),e},this.getDevice=function(){var e={vendor:t,model:t,type:t};return b.rgx.call(e,r,n.device),e},this.getEngine=function(){var e={name:t,version:t};return b.rgx.call(e,r,n.engine),e},this.getOS=function(){var e={name:t,version:t};return b.rgx.call(e,r,n.os),e},this.getResult=function(){return{ua:this.getUA(),browser:this.getBrowser(),engine:this.getEngine(),os:this.getOS(),device:this.getDevice(),cpu:this.getCPU()}},this.getUA=function(){return r},this.setUA=function(e){return r=e,this},this};S.VERSION="0.7.18",S.BROWSER={NAME:n,MAJOR:"major",VERSION:c},S.CPU={ARCHITECTURE:u},S.DEVICE={MODEL:r,VENDOR:a,TYPE:s,CONSOLE:p,MOBILE:l,SMARTTV:h,TABLET:d,WEARABLE:f,EMBEDDED:"embedded"},S.ENGINE={NAME:n,VERSION:c},S.OS={NAME:n,VERSION:c},e&&(e.UAParser=S)}("object"==typeof window?window:this);var oSpPOptions={sAppUrl:"https://akfagroup.com",sAppUrlShow:"https://akfagroup.com",sOrigUrl:"https://akfagroup.com",sOrigFFUrl:"https://akfagroup.com",sSubscribeUrl:"https://akfagroup.spulse.net",sSubscribeFFUrl:"https://akfagroup.spulse.net",sPushHost:"8e7162461417bee0a21462729d592df4",sPushSenderID:"300013155679",bHttps:oSpP=!1,bSendToParent:!0,aBrowser:{},sBrowser:"",sOs:"",sSafariPushId:"web.com.sendpulse.push",sServerApi:"https://pushdata.sendpulse.com:4434",gcmServer:"https://android.googleapis.com/gcm/send/",fcmServer:"https://fcm.googleapis.com/fcm/",mozillaServer:"https://updates.push.services.mozilla.com/wpush/v2/",jsIncludeDomain:"cdn.sendpulse.com",bAutoSubscribe:!0,sAppKey:"f4ed5872a0bcce2c11518d792340f687",prompt_settings:"",prompt_title:"",prompt_text:"",prompt_description:"-",prompt_settings_whithout_sw:'{"title":"","text":"  akfagroup.com      ","style":"sp-popover","textcolor":"#222222","backgroundcolor":"#ffffff","buttoncolor":"#31b58e","iconcolor":"","btncolor":"","allowbtntext":"","disallowbtntext":"","btn_lang":"ru","visit_number":1,"icon":"/files/push/7595283/websites/f4ed5872a0bcce2c11518d792340f687/icons/a93ef6c55077.png"}',currentDB:null,timeSend:null,newWindow:null,parentEvent:null,initedPage:!1,parentVariables:{},pushedVariables:{},pushedInterval:!1,sFirefoxServer:"https://updates.push.services.mozilla.com/push/",sFirefoxServer2:"https://updates.push.services.mozilla.com/wpush/v1/",bWasPrompt:!1,startTime:0,isParentAutoSubscribe:!0,bSentToServer:!1,bSentStatOpened:!1,bSentStatPermission:!1,bMobileEnabled:!0,show_splogo:"1",spdomain_website:"https://sendpulse.com/ru/webpush-powered-by-sendpulse",styles_prefix:"sp",aPoweredbyLabel:{ru:" SendPulse",en:"Powered by SendPulse",ua:" SendPulse"},companyName:"SendPulse",promptHintTitle:{ru:"   !",en:"Subscribe to our notifications!",ua:"   !"},promptHintText:{ru:"     ",en:"Click the bell icon to enable notifications",ua:"  ,    "},iPromptDelay:"10",visitNumber:"1",bMonetization:"false",bIframeEnabled:!1,sUserHostHash:"747991a0e145ac2bbe69f063a9402e69",sSubscriptionPrefix:"SPTYPE:VAPID1:",sVapidPublicKey:"BPzJL10ExgcPxnTp-3ty27bIig0VJ99wfqfNz0-G_95vf7xRXbcQG9ZVG1C37lKlVUFSt7JFK1N9TtIOtrZoJlE",serviceWorkerExists:!1,sPushSubSomain:"spulse.net"};function oPromptPush(){var e=oSpPOptions.sAppUrl,t=oSpPOptions.sAppUrlShow,o=oSpPOptions.sOrigUrl,i=oSpPOptions.sOrigFFUrl,r=oSpPOptions.sPushHost,n=oSpPOptions.sSubscribeUrl,s=(oSpPOptions.sUserHostHash,oSpPOptions.bHttps),a=oSpPOptions.bSendToParent,c=oSpPOptions.jsIncludeDomain,u=oSpPOptions.aBrowser,p=oSpPOptions.sBrowser,l=oSpPOptions.sOs,d=oSpPOptions.sSafariPushId,h=oSpPOptions.sServerApi,f=oSpPOptions.gcmServer,m=oSpPOptions.bAutoSubscribe,b=oSpPOptions.sAppKey,v=oSpPOptions.prompt_settings,g=oSpPOptions.prompt_title,S=oSpPOptions.prompt_text,w=oSpPOptions.prompt_description,y=oSpPOptions.prompt_settings_whithout_sw,P=oSpPOptions.currentDB,_=oSpPOptions.timeSend,D=oSpPOptions.newWindow,E=oSpPOptions.parentEvent,T=oSpPOptions.initedPage,I=oSpPOptions.parentVariables,O=oSpPOptions.pushedVariables,A=oSpPOptions.pushedInterval,N=oSpPOptions.sFirefoxServer,k=oSpPOptions.sFirefoxServer2,M=oSpPOptions.bWasPrompt,C=oSpPOptions.startTime,x=oSpPOptions.isParentAutoSubscribe,L=oSpPOptions.bSentToServer,j=oSpPOptions.bSentStatOpened,B=oSpPOptions.bSentStatPermission,U=oSpPOptions.bMobileEnabled,R=oSpPOptions.show_splogo,z=oSpPOptions.spdomain_website,F=oSpPOptions.styles_prefix,V=oSpPOptions.aPoweredbyLabel,W=oSpPOptions.companyName,H=oSpPOptions.promptHintTitle,K=oSpPOptions.promptHintText,G=oSpPOptions.iPromptDelay,Y=oSpPOptions.visitNumber,Z=oSpPOptions.serviceWorkerExists,Q=new Date,q=new Date(Q.getFullYear(),Q.getMonth()+1,Q.getDate()).getTime();q=Q.getDate()+""+q,oSpPOptions.sPushSubSomain,this.start=function(){if(!oSpP.detectSite())return oSpP.log("Application allowed only for "+e),!1;if("iOS"==oSpP.detectOs())return oSpP.log("Application can not work on iOS"),!1;if(l=oSpP.detectOs(),!U&&("iOS"==l||"Android"==l))return oSpP.log("Application disabled for your device"),!1;if(oSpP.detectHttps(),u=oSpP.detectBrowser(),p=u.name.toLowerCase(),("iOS"==l||"Android"==l)&&"chrome"==p&&parseFloat(u.version)<42)return oSpP.log("Application disabled for your browser version"),!1;if("firefox"==p&&parseFloat(u.version)<44)return oSpP.log("Application can not work with Firefox browser version less then 44"),!1;if("opera"==p&&parseFloat(u.version)<43)return oSpP.log("Application can not work with Opera browser version less then 43"),!1;if(oSpP.isMobileYandexBrowser())return oSpP.log("Application can not work with mobile Yandex browser"),!1;if("firefox"==p&&(o=i),a&&Z){x&&(B=j=!0);var t=setInterval((function(){L&&j&&B&&(oSpP.sendToParent("closeme"),clearInterval(t))}),50)}if(s&&Z)if(m)oSpP.getDbValue("SPIDs","SubscriptionId",(function(e){void 0===e.target.result&&oSpP.getDbValue("SPIDs","PromptClosed",(function(e){if(void 0===e.target.result)oSpP.startDelayedSubscription((function(){oSpP.startSubscription(),"chrome"!=p&&"firefox"!=p&&"opera"!=p||oSpP.checkIsPopUpWindow()||oSpP.showhelpPromptText(),oSpP.isServiceWorkerChromeSupported()&&oSpP.showPushLabel()}));else{var t=parseInt(e.target.result.value);0==--t?(oSpP.deleteDbValue("SPIDs","PromptClosed"),oSpP.startDelayedSubscription((function(){oSpP.startSubscription(),"chrome"!=p&&"firefox"!=p&&"opera"!=p||oSpP.checkIsPopUpWindow()||oSpP.showhelpPromptText(),oSpP.isServiceWorkerChromeSupported()&&oSpP.showPushLabel()}))):oSpP.putValueToDb("SPIDs",{type:"PromptClosed",value:t})}}))}));else{oSpP.getDbValue("SPIDs","SubscriptionId",(function(e){void 0===e.target.result&&oSpP.getDbValue("SPIDs","PromptClosed",(function(e){if(void 0===e.target.result)"chrome"!=p&&"firefox"!=p&&"opera"!=p||oSpP.startDelayedSubscription((function(){oSpP.showCustomPrompt()}));else{var t=parseInt(e.target.result.value);0==--t?(oSpP.deleteDbValue("SPIDs","PromptClosed"),"chrome"!=p&&"firefox"!=p&&"opera"!=p||oSpP.startDelayedSubscription((function(){oSpP.showCustomPrompt()}))):oSpP.putValueToDb("SPIDs",{type:"PromptClosed",value:t})}}))}));for(var r=document.querySelectorAll("."+F+"_notify_prompt"),c=0;c<r.length;c++)r[c].addEventListener("click",(function(){oSpP.startSubscription()}))}else if(window.addEventListener("message",(function(e){e.origin.toLowerCase()==n.toLowerCase()&&"string"==typeof e.data&&("initend"==e.data?clearInterval(_):"closeme"==e.data&&(D.close(),oSpP.storeSubscription(e.data)))}),!1),m)oSpP.getDbValue("SPIDs","SubscriptionId",(function(e){void 0===e.target.result&&oSpP.getDbValue("SPIDs","PromptClosed",(function(e){if(void 0===e.target.result)oSpP.startDelayedSubscription((function(){oSpP.getDbValue("SPIDs","PromptClosed",(function(e){void 0===e.target.result&&oSpP.showCustomPrompt()})),"chrome"!=p&&"firefox"!=p&&"opera"!=p||oSpP.showhelpPromptText(),oSpP.isServiceWorkerChromeSupported()&&oSpP.showPushLabel()}));else{var t=parseInt(e.target.result.value);0==--t?(oSpP.deleteDbValue("SPIDs","PromptClosed"),oSpP.startDelayedSubscription((function(){oSpP.getDbValue("SPIDs","PromptClosed",(function(e){void 0===e.target.result&&oSpP.showCustomPrompt()})),"chrome"!=p&&"firefox"!=p&&"opera"!=p||oSpP.showhelpPromptText(),oSpP.isServiceWorkerChromeSupported()&&oSpP.showPushLabel()}))):oSpP.putValueToDb("SPIDs",{type:"PromptClosed",value:t})}}))}));else for(oSpP.getDbValue("SPIDs","SubscriptionId",(function(e){void 0===e.target.result&&oSpP.getDbValue("SPIDs","PromptClosed",(function(e){if(void 0===e.target.result)oSpP.startDelayedSubscription((function(){oSpP.startDelayedSubscription((function(){oSpP.showCustomPrompt()}))}));else{var t=parseInt(e.target.result.value);0==--t?(oSpP.deleteDbValue("SPIDs","PromptClosed"),oSpP.startDelayedSubscription((function(){oSpP.showCustomPrompt()}))):oSpP.putValueToDb("SPIDs",{type:"PromptClosed",value:t})}}))})),r=document.querySelectorAll("."+F+"_notify_prompt"),c=0;c<r.length;c++)r[c].addEventListener("click",(function(){oSpP.getDbValue("SPIDs","PromptClosed",(function(e){void 0===e.target.result&&oSpP.startSubscription()}))}));a&&Z&&window.addEventListener("message",(function(e){if(oSpP.detectOrigin(e.origin)&&"string"==typeof e.data)if("init"==e.data)(E=e).source.postMessage("initend",E.origin);else if(0===e.data.indexOf("initpage"))2==(t=e.data.split("|")).length&&(T=t[1],localStorage.setItem("source_url",T),oSpP.startSubscription(),oSpP.isServiceWorkerChromeSupported()&&oSpP.showPushLabel());else if(0===e.data.indexOf("initvariables")){var t=e.data.split("|");I=JSON.parse(t[1])}}),!1)},this.startSubscription=function(){if(Z)switch(p){case"chrome":case"firefox":case"opera":navigator.serviceWorker.getRegistrations().then((function(e){if(e)for(var t=0;t<e.length;t++)e[t].active&&-1!=e[t].active.scriptURL.indexOf(F+"-push-worker.js")&&e[t].unregister()})),oSpP.isServiceWorkerChromeSupported()&&(oSpP.log("ASK for Permission"),C=Date.now(),Notification.requestPermission(oSpP.doActionsWithPermissions),oSpP.registerChrome())}else oSpP.showPopUp()},this.clearDomain=function(e){return e.replace("://www.","://").replace("://www2.","://")},this.detectSite=function(){var o=!(-1===oSpP.clearDomain(window.location.href.toLowerCase()).indexOf(oSpP.clearDomain(e.toLowerCase())));return o||(o=!(-1===oSpP.clearDomain(window.location.href.toLowerCase()).indexOf(oSpP.clearDomain(t.toLowerCase()))))||!(-1===oSpP.clearDomain(window.location.href.toLowerCase()).indexOf(oSpP.clearDomain(n.toLowerCase())))},this.detectOrigin=function(e){return!(-1===oSpP.clearDomain(e.toLowerCase()).indexOf(oSpP.clearDomain(o.toLowerCase())))},this.detectHttps=function(){s=0===window.location.href.indexOf("https://")},this.log=function(e){},this.detectBrowser=function(){var e,t=navigator.userAgent,o=t.match(/(opera|chrome|safari|firefox|msie|trident(?=\/))\/?\s*(\d+)/i)||[],i=t.match(/(edge(?=\/))\/?\s*(\d+)/i)||[];return"Edge"===i[1]?{name:i[1],version:i[2]}:/trident/i.test(o[1])?{name:"IE",version:(e=/\brv[ :]+(\d+)/g.exec(t)||[])[1]||""}:"Chrome"===o[1]&&null!=(e=t.match(/\bOPR\/(\d+)/))?{name:"Opera",version:e[1]}:(o=o[2]?[o[1],o[2]]:[navigator.appName,navigator.appVersion,"-?"],null!=(e=t.match(/version\/(\d+)/i))&&o.splice(1,1,e[1]),{name:o[0],version:o[1]})},this.isMobileYandexBrowser=function(){var e=navigator.userAgent;return e.match(/(opera|yabrowser|chrome|safari|firefox|msie|trident(?=\/))\/?\s*(\d+)/i),"YaBrowser"===(e.match(/(YaBrowser(?=\/))\/?\s*(\d+)/i)||[])[1]&&("iOS"==oSpP.detectOs()||"Android"==oSpP.detectOs())},this.isServiceWorkerChromeSupported=function(){return"serviceWorker"in navigator},this.isSafariNotificationSupported=function(){return"safari"in window&&"pushNotification"in window.safari},this.getBrowserlanguage=function(){return navigator.language.substring(0,2)},this.setCookie=function(e,t,o){var i=new Date;i.setTime(i.getTime()+24*o*60*60*1e3);var r="expires="+i.toUTCString();document.cookie=e+"="+t+"; "+r},this.checkCookie=function(e){for(var t=e+"=",o=document.cookie.split(";"),i=0;i<o.length;i++){for(var r=o[i];" "==r.charAt(0);)r=r.substring(1);if(0==r.indexOf(t))return r.substring(t.length,r.length)}return""},this.doActionsWithPermissions=function(e){var t=Date.now()-C;switch(M=!(t<50),oSpP.hideHintDiv(),oSpP.log("[DD] Permissions: "+e),oSpP.log("[DD] Time diff: "+t),e){case"granted":switch(x||M&&oSpP.getDbValue("SPIDs","PromptShowed",(function(e){void 0===e.target.result?(oSpP.sendPromptStat("prompt_showed"),oSpP.sendPromptStat("prompt_granted"),oSpP.putValueToDb("SPIDs",{type:"PromptShowed",value:1})):(oSpP.sendPromptStat("prompt_showed_again"),oSpP.sendPromptStat("prompt_granted"))})),p){case"chrome":case"firefox":case"opera":oSpP.subscribe()}break;case"default":x||M&&oSpP.getDbValue("SPIDs","PromptShowed",(function(e){void 0===e.target.result?(oSpP.sendPromptStat("prompt_showed"),oSpP.sendPromptStat("prompt_closed"),oSpP.putValueToDb("SPIDs",{type:"PromptShowed",value:1})):(oSpP.sendPromptStat("prompt_showed_again"),oSpP.sendPromptStat("prompt_closed"))}));break;case"denied":x?M&&(oSpP.sendToParent("closeme"),oSpP.sendPromptStat("prompt_denied")):M&&oSpP.getDbValue("SPIDs","PromptShowed",(function(e){void 0===e.target.result?(oSpP.sendPromptStat("prompt_showed"),oSpP.sendPromptStat("prompt_denied"),oSpP.putValueToDb("SPIDs",{type:"PromptShowed",value:1})):(oSpP.sendPromptStat("prompt_showed_again"),oSpP.sendPromptStat("prompt_denied"))}))}m?"default"==e?oSpP.closePromptHelpText(!1):"granted"==e?oSpP.closePromptHelpText(!0):(oSpP.closePromptHelpText(!0),oSpP.sendPromptStat("prompt_denied")):"default"==e?oSpP.closeCustomPrompt(!1):oSpP.closeCustomPrompt(!0),oSpP.closePushLabel()},this.registerChrome=function(){navigator.serviceWorker.register("/"+F+"-push-worker-fb.js",{updateViaCache:"none"}).then((function(e){e.installing?oSpP.log("Service worker installing"):e.waiting?oSpP.log("Service worker installed"):e.active&&oSpP.log("Service worker active")}))},this.checkIsServiceWorkerExitsAndInitPrompt=function(e){e&&(m=!0,G=0,Y=1);try{var t=new XMLHttpRequest;t.open("GET","/"+F+"-push-worker-fb.js"),t.onload=function(e){Z=4==t.readyState&&200==t.status,oSpP.initPrompt()},t.send(null),t.onerror=function(){}}catch(e){Z=!1,oSpP.initPrompt()}},this.checkSafariPermission=function(e){oSpP.log("[DD] Permissions: "+e.permission),"default"===e.permission?(m?oSpP.closePromptHelpText(!1):oSpP.closeCustomPrompt(!1),M=!0,oSpP.getDbValue("SPIDs","PromptShowed",(function(e){void 0===e.target.result?(oSpP.sendPromptStat("prompt_showed"),oSpP.putValueToDb("SPIDs",{type:"PromptShowed",value:1})):oSpP.sendPromptStat("prompt_showed_again")})),window.safari.pushNotification.requestPermission(h,d,{appkey:b},oSpP.checkSafariPermission)):"denied"===e.permission?(m?oSpP.closePromptHelpText(!0):oSpP.closeCustomPrompt(!0),M&&oSpP.sendPromptStat("prompt_denied"),oSpP.sendToParent("closeme")):"granted"===e.permission&&(oSpP.uns(),m?oSpP.closePromptHelpText(!0):oSpP.closeCustomPrompt(!0),M&&oSpP.sendPromptStat("prompt_granted"),oSpP.subscribe()),oSpP.closePushLabel()},this.initialiseState=function(e){e.showNotification||oSpP.log("Notifications aren't supported on service workers."),"denied"!==Notification.permission?"PushManager"in window||oSpP.log("Push messaging isn't supported."):oSpP.log("The user has blocked notifications.")},this.endpointWorkaround=function(e){switch(p){case"chrome":case"opera":if("subscriptionId"in e)var t=e.subscriptionId;else t=e.endpoint;return~t.indexOf(f)?t.split(f)[1]:~t.indexOf(oSpPOptions.fcmServer+"send/")?t.split(oSpPOptions.fcmServer+"send/")[1]:t;case"firefox":return~(t=e.endpoint).indexOf(N)?t.split(N)[1]:~t.indexOf(k)?t.split(k)[1]:t}},this.fetchFcmToken=function(e,t,o){return new Promise((function(i,r){var n=oSpPOptions.fcmServer+"send/"+encodeURIComponent(e),s="authorized_entity="+oSpPOptions.sPushSenderID;return s+="&endpoint="+n,s+="&encryption_key="+encodeURIComponent(t),s+="&encryption_auth="+encodeURIComponent(o),fetch(oSpPOptions.fcmServer+"connect/subscribe",{method:"post",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:s}).then((function(e){if(200==e.status)return e.json().then((function(e){i(e.token)}));i(void 0)})).catch((function(e){r(e)}))}))},this.getVapidToken=function(e){return new Promise((function(t,o){oSpP.getDbValue("SPIDs","SubscriptionIdVapid",(function(o){void 0===o.target.result?(oSpP.putValueToDb("SPIDs",{type:"SubscriptionIdVapid",value:e}),t(!1)):t(!0)}))}))},this.subscribe=function(){switch(p){case"chrome":case"firefox":case"opera":navigator.serviceWorker.ready.then((function(e){e.pushManager.subscribe({userVisibleOnly:!0,applicationServerKey:oSpP.urlBase64ToUint8Array(oSpPOptions.sVapidPublicKey)}).then((function(e){var t=oSpP.endpointWorkaround(e),o=e.getKey?e.getKey("p256dh"):"",i=o?btoa(String.fromCharCode.apply(null,new Uint8Array(o))):"",r=e.getKey?e.getKey("auth"):"",n=r?btoa(String.fromCharCode.apply(null,new Uint8Array(r))):"";oSpP.checkLocalSubsctoption(t,i,n),a&&oSpP.sendToParent(t)})).catch((function(t){11==t.code&&navigator.serviceWorker.getRegistrations().then((function(t){for(var o=0;o<t.length;o++)-1==t[o].active.scriptURL.indexOf("OneSignalSDKWorker.js")&&-1==t[o].active.scriptURL.indexOf("pushcrew-sw.js")&&-1==t[o].active.scriptURL.indexOf("push-worker.js")&&-1==t[o].active.scriptURL.indexOf("sw.js")&&-1==t[o].active.scriptURL.indexOf("service-worker.js")&&-1==t[o].active.scriptURL.indexOf("pushwoosh-service-worker.js")&&-1==t[o].active.scriptURL.indexOf("serviceworker.js")&&-1==t[o].active.scriptURL.indexOf(F+"-push-worker-fb.js")||t[o].unregister().then((function(){navigator.serviceWorker.getRegistration().then((function(t){void 0!==t?-1==t.active.scriptURL.indexOf("OneSignalSDKWorker.js")&&-1==t.active.scriptURL.indexOf("pushcrew-sw.js")&&-1==t.active.scriptURL.indexOf("push-worker.js")&&-1==t.active.scriptURL.indexOf("sw.js")&&-1==t.active.scriptURL.indexOf("service-worker.js")&&-1==t.active.scriptURL.indexOf("pushwoosh-service-worker.js")||t.unregister().then((function(){e.pushManager.getSubscription().then((function(e){e?e.unsubscribe().then((function(e){window.location.reload()})):window.location.reload()}))})):e.pushManager.getSubscription().then((function(e){e?e.unsubscribe().then((function(e){window.location.reload()})):window.location.reload()}))}))}))}))}))}))}},this.checkLocalSubsctoption=function(e,t,o,i){oSpP.log("[DD] subscribe :: subscriptionId: "+e),oSpP.getDbValue("SPIDs","SubscriptionId",(function(i){void 0===i.target.result?(oSpP.sendSubscribeDataToServer(e,"subscribe",void 0,t,o),oSpP.putValueToDb("SPIDs",{type:"SubscriptionId",value:e})):i.target.result.value!==e&&(oSpP.sendSubscribeDataToServer(i.target.result.value,"unsubscribe"),oSpP.sendSubscribeDataToServer(e,"subscribe",void 0,t,o),oSpP.putValueToDb("SPIDs",{type:"SubscriptionId",value:e}))}))},this.unsubscribe=function(){switch(p){case"chrome":case"firefox":case"opera":navigator.serviceWorker.ready.then((function(e){e.pushManager.getSubscription().then((function(e){oSpP.endpointWorkaround(e),e&&e.unsubscribe().then((function(e){}))}))}))}},this.getUserVariables=function(){for(var e={},t=document.querySelectorAll("input.sp_push_custom_data"),o=0;o<t.length;o++)switch(t[o].type){case"text":case"hidden":e[t[o].name]=t[o].value;break;case"checkbox":e[t[o].name]=t[o].checked?1:0;break;case"radio":t[o].checked&&(e[t[o].name]=t[o].value)}return e},this.sendSubscribeDataToServer=function(e,t,o,i,n){var s=new XMLHttpRequest;a&&"subscribe"==t&&(s.onreadystatechange=function(){4==s.readyState&&200==s.status&&(L=!0)}),s.open("POST",h,!0),s.setRequestHeader("Content-Type","application/json"),void 0===o&&((o={}).uname=oSpP.checkCookie("lgn"),o.os=oSpP.detectOs()),void 0===i&&(i=""),o.variables=a&&!Z?I:oSpP.getUserVariables();var c,l=-(new Date).getTimezoneOffset()/60;(o.timezoneoffset=l,T)?c=T:c=localStorage.getItem("source_url")||window.location.href;var d=oSpPOptions.sSubscriptionPrefix;switch(p){case"safari":case"firefox":d=""}var f={action:"subscription",subscriptionId:e,subscription_action:t,subscription_type:d,appkey:b,browser:u,lang:oSpP.getBrowserlanguage(),url:c,sPubKey:i,sAuthKey:n,sPushHostHash:r,custom_data:o};s.send(JSON.stringify(f))},this.initDb=function(e){if(P)e();else{var t=(window.indexedDB||window.mozIndexedDB||window.webkitIndexedDB||window.msIndexedDB).open(W.toLowerCase()+"_push_db",2);t.onsuccess=function(t){P=t.target.result,e()},t.onupgradeneeded=function(e){e.target.result.createObjectStore("SPIDs",{keyPath:"type"})}}},this.getDbValue=function(e,t,o){oSpP.initDb((function(){P.transaction([e],"readonly").objectStore(e).get(t).onsuccess=o}))},this.putValueToDb=function(e,t){oSpP.initDb((function(){P.transaction([e],"readwrite").objectStore(e).put(t)}))},this.deleteDbValue=function(e,t){oSpP.initDb((function(){P.transaction([e],"readwrite").objectStore(e).delete(t)}))},this.uns=function(){oSpP.deleteDbValue("SPIDs","SubscriptionId")},this.detectOs=function(){return-1!=navigator.userAgent.indexOf("Windows")?"Windows":-1!=navigator.userAgent.indexOf("Android")?"Android":-1!=navigator.userAgent.indexOf("Linux")?"Linux":-1!=navigator.userAgent.indexOf("iPhone")||-1!=navigator.userAgent.indexOf("iPad")?"iOS":-1!=navigator.userAgent.indexOf("Mac")?"Mac OS":-1!=navigator.userAgent.indexOf("FreeBSD")?"FreeBSD":""},this.sendToParent=function(e){if(null===E)var t=setInterval((function(){null!==E&&(E.source.postMessage(e,E.origin),clearInterval(t))}),100);else E.source.postMessage(e,E.origin)},this.removeTransparentDiv=function(){if(0<document.getElementsByClassName(F+"-resubscribe-div").length){var e=document.getElementsByClassName(F+"-resubscribe-div")[0];document.body.removeChild(e)}},this.showPopUp=function(){null!=D&&D.close(),oSpP.removeTransparentDiv(),m&&oSpP.sendPromptStat("prompt_granted");var e=void 0!==window.screenLeft?window.screenLeft:screen.left,t=void 0!==window.screenTop?window.screenTop:screen.top,o=window.innerWidth?window.innerWidth:document.documentElement.clientWidth?document.documentElement.clientWidth:screen.width,i=window.innerHeight?window.innerHeight:document.documentElement.clientHeight?document.documentElement.clientHeight:screen.height,s=o/2-290+e,a=i/3-i/3+t,c=oSpP.getBrowserlanguage();""==c&&(c="en"),D=window.open(n+"/"+c+"/"+b+"/"+r,"_blank","scrollbars=yes, width=580, height=580, top="+a+", left="+s),window.focus&&D.focus(),_=setInterval((function(){D.postMessage("init",n),D.postMessage("initpage|"+window.location.href,n),D.postMessage("initvariables|"+JSON.stringify(oSpP.getUserVariables()),n)}),100),m?oSpP.closePrompt(!0):Z||oSpP.closePrompt(!0)},this.closePrompt=function(e){void 0===e&&oSpP.sendPromptStat("prompt_closed"),0<document.getElementsByClassName(F+"-prompt").length&&document.body.removeChild(document.querySelector("."+F+"-prompt")),0<document.getElementsByClassName(F+"-prompt-backdrop").length&&document.body.removeChild(document.querySelector("."+F+"-prompt-backdrop")),oSpP.putValueToDb("SPIDs",{type:"PromptClosed",value:5})},this.push=function(t,o){if(!oSpP.detectSite())return oSpP.log("Application allowed only for "+e),!1;O[t]=o,oSpP.getDbValue("SPIDs","SubscriptionId",(function(e){void 0===e.target.result?A=A||setInterval((function(){oSpP.getDbValue("SPIDs","SubscriptionId",(function(e){void 0!==e.target.result&&(oSpP.sendUpdatesToServer(e.target.result.value),clearInterval(A),A=!1)}))}),1e3):oSpP.sendUpdatesToServer(e.target.result.value)}))},this.sendUpdatesToServer=function(e){var t=oSpPOptions.sSubscriptionPrefix;switch(p){case"safari":case"firefox":t=""}var o=new XMLHttpRequest;o.open("POST",h,!0),o.setRequestHeader("Content-Type","application/json");var i={action:"subscription",subscriptionId:e,subscription_type:t,subscription_action:"update_variables",appkey:b,sPushHostHash:r,custom_data:{variables:O}};o.send(JSON.stringify(i))},this.sendPromptStat=function(e){"prompt_denied"===e&&oSpP.putValueToDb("SPIDs",{type:"SubscriptionId",value:"denied"})},this.showhelpPromptText=function(){var e=document.getElementsByTagName("head")[0],t=document.createElement("link");if(t.rel="stylesheet",t.type="text/css",t.href="https://"+c+"/dist/css/push/"+W.toLowerCase()+"-prompt.min.css?v="+q,t.media="all",e.appendChild(t),0<=w.length&&"-"!=w){var o=document.createElement("div");o.setAttribute("class",F+"-backdrop-info"),o.setAttribute("style","display:none;");var i=document.createElement("div");i.setAttribute("class","backdrop-close"),i.innerHTML+="<big></big><br><small>ESC</small>",i.setAttribute("onclick","oSpP.closePromptHelpText(false); return false;"),o.appendChild(i);var r=document.createElement("div");if(r.setAttribute("class","backdrop-message"),r.innerHTML+=w,o.appendChild(r),"chrome"===u.name.toLowerCase()){var n=this.getPushHintDiv();o.appendChild(n)}document.body.insertBefore(o,document.body.childNodes[0]),setTimeout((function(){oSpP.getDbValue("SPIDs","PromptClosed",(function(e){void 0===e.target.result&&(o.className+=o.className?" show-prompt":"show-prompt")}))}),1e3)}},this.showPushLabel=function(){if(Z){var e=!0,t=new UAParser,i=t.getBrowser();if(i.os=t.getOS().name,void 0!==R&&0==R&&(e=!1),e){var r=document.createElement("div"),n='<a class="'+F+'-brand-link" rel="nofollow" target="_blank" href="'+z+(-1!==z.indexOf("?")?"&":"?")+"utm_source="+encodeURI(o.replace(/(^\w+:|^)\/\//,""))+'&utm_medium=referral&utm_campaign=pushrequest">Web Push <span>'+W+"</span></a>";if(document.getElementsByClassName(F+"-backdrop-info").length){if(r.setAttribute("class",F+"-bottom-push-label "+F+"-show"),r.innerHTML+=n,"chrome"===i.name.toLowerCase()&&!document.getElementsByClassName(F+"-hint-popover").length){var s=this.getPushHintDiv();document.getElementsByClassName(F+"-backdrop-info")[0].appendChild(s)}document.getElementsByClassName(F+"-backdrop-info")[0].appendChild(r)}else{var a=F+"-"+l.toLowerCase().replace(" ",""),c=F+"-lang-"+oSpP.getBrowserlanguage().toLowerCase().replace(" ",""),u=F+"-"+i.name.toLowerCase().replace(" ",""),p=u+i.major;r.setAttribute("style","display:none"),r.setAttribute("class",F+"-webpush-label "+a+" "+u+" "+c+" "+p),r.setAttribute("onclick","this.remove();");var d=document.createElement("div");d.setAttribute("class",F+"-inner-content"),d.innerHTML+=n,"chrome"===i.name.toLowerCase()&&(s=this.getPushHintDiv(),r.appendChild(s)),r.appendChild(d),document.body.insertBefore(r,document.body.childNodes[0])}setTimeout((function(){if(null!==document.querySelector("."+F+"-webpush-label")){var e=document.querySelector("."+F+"-webpush-label");e.setAttribute("class",e.getAttribute("class")+" "+F+"-show")}}),1e3)}}},this.getPushHintDiv=function(){var e=oSpP.getMessageLang(oSpP.getBrowserlanguage()),t=document.createElement("div");t.setAttribute("class",F+"-prompt "+F+"-hint-popover show-prompt");var o=document.createElement("div");o.setAttribute("class",F+"-prompt-message");var i=document.createElement("div");i.setAttribute("class",F+"-table-wrapper");var r=document.createElement("div");r.setAttribute("class",F+"-cell"),r.innerHTML+=H[e];var n=document.createElement("div");n.setAttribute("class",F+"-cell"),n.innerHTML="<img src='data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTAwIiBoZWlnaHQ9IjI4IiB2aWV3Qm94PSIwIDAgMTAwIDI4IiBmaWxsPSJub25lIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciPjxwYXRoIGQ9Ik0wIDBIODZDOTMuNzMyIDAgMTAwIDYuMjY4MDEgMTAwIDE0VjE0QzEwMCAyMS43MzIgOTMuNzMyIDI4IDg2IDI4SDBWMFoiIGZpbGw9InVybCgjcGFpbnQwX2xpbmVhcikiLz48cGF0aCBkPSJNOTAgMTEuNjkwMUw4NC4yNTU3IDExLjIwMDlMODIgNkw3OS43NDQzIDExLjIwMDlMNzQgMTEuNjkwMUw3OC4zODAzIDE1LjM5NzdMNzcuMDY4OSAyMC45MzMzTDgyIDE3Ljk5ODJMODYuOTU3NCAyMC45MzMzTDg1LjY0NTkgMTUuMzk3N0w5MCAxMS42OTAxWk04MiAxNi41MzA2TDc4Ljk4MzYgMTguMzA3MUw3OS43OTY3IDE0LjkzNDNMNzcuMTIxMyAxMi42OTQzTDgwLjYzNjEgMTIuMzg1M0w4MiA5LjIxODM5TDgzLjM2MzkgMTIuMzg1M0w4Ni44Nzg3IDEyLjY5NDNMODQuMjI5NSAxNC45Nkw4NS4wNDI2IDE4LjMzMjlMODIgMTYuNTMwNloiIGZpbGw9IiM0RDUyNUUiLz48cGF0aCBkPSJNNTEuMjcyNyAxOC45MDA4QzUxLjI3MjcgMTkuNjI4MSA1MC42Nzc3IDIwLjIyMzEgNDkuOTUwNCAyMC4yMjMxQzQ5LjIyMzEgMjAuMjIzMSA0OC42MjgxIDE5LjYyODEgNDguNjI4MSAxOC45MDA4SDUxLjI3MjdaTTU1LjA2NzggMTkuOTM4OEw1My4zNjg2IDE4LjIzOTdINDRMNDUuOTgzNSAxNi4yNTYyVjEyLjI4OTNDNDUuOTgzNSAxMS44NTk1IDQ2LjA0OTYgMTEuNDQzIDQ2LjE4MTggMTEuMDUyOUw0NC4zMTA3IDkuMTgxODJMNDUuMjQ5NiA4LjI0OTU5TDQ2LjgzNjQgOS44MzYzNkw1NiAxOUw1NS4wNjc4IDE5LjkzODhaTTQ5LjI4OTMgOC4zNzUyMVY3LjY2MTE2QzQ5LjI4OTMgNy4yOTc1MiA0OS41ODY4IDcgNDkuOTUwNCA3QzUwLjMxNCA3IDUwLjYxMTYgNy4yOTc1MiA1MC42MTE2IDcuNjYxMTZWOC4zNzUyMUM1Mi40ODkzIDguNjkyNTYgNTMuOTE3NCAxMC4zMjU2IDUzLjkxNzQgMTIuMjg5M1YxNS4wNDYzTDQ3LjgxNDkgOC45NDM4QzQ4LjI1NzkgOC42NTI4OSA0OC43NTM3IDguNDY3NzcgNDkuMjg5MyA4LjM3NTIxWiIgZmlsbD0iIzRENTI1RSIvPjxkZWZzPjxsaW5lYXJHcmFkaWVudCBpZD0icGFpbnQwX2xpbmVhciIgeDE9IjEwMCIgeTE9IjE0IiB4Mj0iMS4xMzg0NWUtMDciIHkyPSIxNCIgZ3JhZGllbnRVbml0cz0idXNlclNwYWNlT25Vc2UiPjxzdG9wIG9mZnNldD0iMC42NDkyNDkiIHN0b3AtY29sb3I9IiNEMEQyRDgiLz48c3RvcCBvZmZzZXQ9IjEiIHN0b3AtY29sb3I9IiNEMEQyRDgiIHN0b3Atb3BhY2l0eT0iMCIvPjwvbGluZWFyR3JhZGllbnQ+PC9kZWZzPjwvc3ZnPg=='>",i.appendChild(r),i.appendChild(n);var s=document.createElement("div");return s.setAttribute("class",F+"-prompt-message-text"),s.innerHTML=K[e],o.appendChild(i),o.appendChild(s),t.appendChild(o),t},this.showCustomPrompt=function(){oSpP.getDbValue("SPIDs","PromptShowed",(function(e){void 0===e.target.result?(oSpP.sendPromptStat("prompt_showed"),oSpP.putValueToDb("SPIDs",{type:"PromptShowed",value:1})):oSpP.sendPromptStat("prompt_showed_again")}));var e,t=document.getElementsByTagName("head")[0],o=document.createElement("link");o.rel="stylesheet",o.type="text/css",o.href="https://"+c+"/dist/css/push/"+W.toLowerCase()+"-prompt.min.css?v="+q,o.media="all",t.appendChild(o);var i=F+"-popover",r="display:none;",n=!0;void 0!==R&&0==R&&(n=!1);var s=oSpP.getMessageLang(oSpP.getBrowserlanguage());if(v.length<=0&&0<y.length&&!Z&&m&&(v=y,e=JSON.parse(v),S=e.text),0<v.length){if("Sendbox"===W)var a='<img src="data:image/svg+xml;base64,PHN2ZyBpZD0i0KHQu9C+0LlfMSIgZGF0YS1uYW1lPSLQodC70L7QuSAxIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCAxNSAxNSI+PGRlZnM+PHN0eWxlPi5jbHMtMXtmaWxsOiNmNjEzODk7fS5jbHMtMntmaWxsOiMwMDg0ZmY7fS5jbHMtM3tmaWxsOiM0MDRhY2M7fTwvc3R5bGU+PC9kZWZzPjx0aXRsZT5sb2dvLXNlbmRib3g8L3RpdGxlPjxwYXRoIGNsYXNzPSJjbHMtMSIgZD0iTTMuMSw0LjE3SDguMjZhLjgyLjgyLDAsMCwwLDAtMS42NEgzLjFhLjgyLjgyLDAsMCwwLDAsMS42NFoiLz48cGF0aCBjbGFzcz0iY2xzLTEiIGQ9Ik00LjA4LDExSDMuNTNhLjgyLjgyLDAsMCwwLDAsMS42NGguNTVhLjgyLjgyLDAsMCwwLDAtMS42NFoiLz48cGF0aCBjbGFzcz0iY2xzLTEiIGQ9Ik0xLjcyLDdIM0EuODIuODIsMCwwLDAsMyw1LjM5SDEuNzJBLjgyLjgyLDAsMCwwLDEuNzIsN1oiLz48cGF0aCBjbGFzcz0iY2xzLTEiIGQ9Ik0xMS40NiwxMUg2LjY4YS44Mi44MiwwLDAsMCwwLDEuNjRoNC43OGEuODIuODIsMCwwLDAsMC0xLjY0WiIvPjxwYXRoIGNsYXNzPSJjbHMtMSIgZD0iTTQuMDgsOC4yOEguODFhLjgyLjgyLDAsMCwwLDAsMS42NEg0LjA4YS44Mi44MiwwLDAsMCwwLTEuNjRaIi8+PHBhdGggY2xhc3M9ImNscy0yIiBkPSJNOC4wOCw5LjI0bC4xNi4wNy4xMywwSDguN2wuMTMsMEw5LDkuMjRIOWwyLjg2LTEuOTRBLjgyLjgyLDAsMSwwLDExLDUuOTNMOC41NCw3LjU4LDYuMSw1LjkzYS44NC44NCwwLDAsMC0xLjE2LjIuODMuODMsMCwwLDAsLjI1LDEuMTZMOCw5LjIzWiIvPjxwYXRoIGNsYXNzPSJjbHMtMiIgZD0iTTE0LjE4LDIuNTNhLjgyLjgyLDAsMCwxLC44Mi44MnY4LjQ4YS44Mi44MiwwLDAsMS0uODIuODJIMTFBLjgyLjgyLDAsMCwxLDExLDExaDIuMzlWNC4xN0g3LjgzYS44Mi44MiwwLDAsMSwwLTEuNjRaIi8+PGVsbGlwc2UgY2xhc3M9ImNscy0zIiBjeD0iMTAuOTgiIGN5PSIxMS44MyIgcng9IjAuODEiIHJ5PSIwLjgyIi8+PGVsbGlwc2UgY2xhc3M9ImNscy0zIiBjeD0iNy44MyIgY3k9IjMuMzUiIHJ4PSIwLjgxIiByeT0iMC44MiIvPjwvc3ZnPg==">';else a='<img src="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTYiIGhlaWdodD0iMTYiIHZpZXdCb3g9IjAgMCAxNiAxNiIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4gICAgPHJlY3Qgd2lkdGg9IjE2IiBoZWlnaHQ9IjE2IiByeD0iMiIgZmlsbD0iIzAwQTJDMCIvPiAgICA8cGF0aCBmaWxsLXJ1bGU9ImV2ZW5vZGQiIGNsaXAtcnVsZT0iZXZlbm9kZCIgZD0iTTEzLjUwNjQgOC4wOTYzOVY4LjQzMzc0VjguNjAyNDFMMTMuNDkwMiA5SDExLjg1OUg4LjQxNTc5SDguMTIyMDZMOC4wODMyMiA4LjcwNzI1TDcuNTk3NjEgNS4zNDc1NUw1LjM5MDY0IDEzLjc0ODhMNS4zMjQ2NiAxNEg1LjA2NjI2SDMuODQ0MzJIMy41Nzg4OUwzLjUxNzgxIDEzLjc0MDNMMi4zNTA3MyA5SDAuMzM1NTA5SDBWOC43NTE3NVY3LjI2NDU3VjdIMC4zMzU1MDlIMy42MDg4OUgzLjg2MDUyTDMuODk2NjMgNy4xODc1NEw0LjQ5ODkgOS44NTM5N0w2Ljk3NDcyIDAuMjUyNjgyTDcuMDM5ODcgMEg3LjI5OTQ5SDguNTU0MDZIOC44NTExMUw4Ljg4NzEgMC4yOTY0NzdMOS43MjgxNSA3LjAxODg3SDExLjgyODlMMTIuMzE1OSA3LjAxODg2TDEyLjYzMDkgNy4wMTg4N0gxMy40OTAyTDEzLjUwNjQgNy4xODc1NFY3LjM1NjIyVjguMDk2MzlaIiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgxIDEpIiBmaWxsPSJ3aGl0ZSIvPiAgICA8cGF0aCBkPSJNMTQuNDEyIDhDMTQuNDEyIDguOTc4MTQgMTMuNjIzMyA5Ljc3MTA4IDEyLjY1MDUgOS43NzEwOEMxMS42Nzc3IDkuNzcxMDggMTAuODg5MSA4Ljk3ODE0IDEwLjg4OTEgOEMxMC44ODkxIDcuMDIxODYgMTEuNjc3NyA2LjIyODkxIDEyLjY1MDUgNi4yMjg5MUMxMy42MjMzIDYuMjI4OTEgMTQuNDEyIDcuMDIxODYgMTQuNDEyIDhaIiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgxIDEpIiBmaWxsPSJ3aGl0ZSIvPjwvc3ZnPg==">';var u='<svg style="display: none;"><symbol id="sp_bell_icon"><path d="M139.165 51.42L103.39 15.558C43.412 61.202 3.74 132.185 0 212.402h50.174c3.742-66.41 37.877-124.636 88.99-160.98zM474.98 212.403h50.173c-3.742-80.217-43.413-151.2-103.586-196.845L385.704 51.42c51.398 36.346 85.533 94.572 89.275 160.982zm-49.388 12.582c0-77-53.39-141.463-125.424-158.487v-17.09c0-20.786-16.76-37.613-37.592-37.613s-37.592 16.827-37.592 37.614v17.09C152.95 83.52 99.56 148.004 99.56 224.983v137.918L49.408 413.01v25.076h426.336V413.01l-50.152-50.108V224.984zM262.576 513.358c3.523 0 6.76-.22 10.065-1.007 16.237-3.237 29.825-14.528 36.06-29.626 2.517-5.952 4.05-12.494 4.05-19.54H212.4c0 27.593 22.582 50.174 50.174 50.174z" /></symbol></svg>';(i=(e=JSON.parse(v)).style)===F+"-popover"&&(i=F+"-native-popover");var p=document.createElement("div"),l=F+"-prompt "+i;p.setAttribute("class",l),0<e.backgroundcolor.length&&i!=F+"-fab"&&(r=r+"background-color: "+e.backgroundcolor+";"),p.setAttribute("style",r);var d=document.createElement("div");d.setAttribute("class",F+"-prompt-message");var h=document.createElement("img");if(h.setAttribute("class",F+"-bell-icon"),h.setAttribute("width","14"),h.setAttribute("height","14"),h.setAttribute("src","https://"+c+"/img/push/icon-ring.svg"),n){var f=document.createElement("span");f.setAttribute("class",F+"-link-wrapper"),(A=document.createElement("a")).setAttribute("class",F+"-link"),A.setAttribute("href",z),A.setAttribute("target","_blank");var b=document.createElement("span");i===F+"-modal"&&(A.setAttribute("style","color: "+e.textcolor+" !important;"),f.setAttribute("style","color: "+e.textcolor+" !important;"),b.setAttribute("style","color: "+e.textcolor+" !important;")),b.innerHTML=V[s],i!=F+"-bar"&&(A.innerHTML=a),A.appendChild(b),f.appendChild(A)}if(i===F+"-native-popover"){r=r+"color: "+e.textcolor+" !important;",p.setAttribute("style",r),void 0!==e.custom&&void 0!==e.custom.prompt_position&&(l+=" "+F+"-pos-"+e.custom.prompt_position,p.setAttribute("class",l)),(M=document.createElement("div")).setAttribute("class",F+"-native-info-inner "+F+"-table-wrapper");var w=document.createElement("div");w.setAttribute("class",F+"-cell"),h.setAttribute("src","https://"+c+e.icon),h.setAttribute("width","64"),h.setAttribute("height","64"),w.appendChild(h);var P=document.createElement("div");P.setAttribute("class",F+"-cell");var _=document.createElement("div");_.setAttribute("class",F+"-prompt-info "+F+"-prompt-message-text"),_.innerHTML+=S,P.appendChild(_),M.appendChild(w),M.appendChild(P)}else if(i==F+"-bar"){(M=document.createElement("div")).setAttribute("class",F+"-prompt-info "+F+"-prompt-message-text"),M.setAttribute("style","color: "+e.textcolor+" !important;"),M.innerHTML+=S;var D=document.createElement("span");d.innerHTML+=u+'<svg viewBox="0 0 525.153 525.153" width="40" height="40" xmlns:xlink="http://www.w3.org/1999/xlink" class="'+F+'-bell-icon"><use class="'+F+'-bell-path" style="fill: '+e.textcolor+' !important;" xlink:href="#sp_bell_icon" x="0" y="0" />  </svg>'}else if(i==F+"-fab"){if((M=document.createElement("div")).setAttribute("class",F+"-prompt-title "+F+"-prompt-message-text"),0<e.textcolor.length&&M.setAttribute("style","color: "+e.textcolor+" !important;"),M.innerHTML=g,(D=document.createElement("div")).setAttribute("class",F+"-prompt-info "+F+"-prompt-message-text"),0<e.textcolor.length&&D.setAttribute("style","color: "+e.textcolor+" !important;"),D.innerHTML+=S,void 0!==e.custom&&void 0!==e.custom.prompt_size&&"big"===e.custom.prompt_size){D=null,l=F+"-prompt "+F+"-floating-panel",p.setAttribute("class",l),d.setAttribute("style","background-color: "+e.btncolor+"; color: "+e.textcolor+" !important;"),d.setAttribute("onclick","oSpP.startSubscription(); return false;"),(M=document.createElement("div")).setAttribute("style","color: "+e.textcolor+" !important;"),M.setAttribute("class",F+"-table-wrapper");var E=document.createElement("div");E.setAttribute("class",F+"-cell");var T=document.createElement("a");T.innerHTML+='<svg viewBox="0 0 525.153 525.153" width="40" height="40" xmlns:xlink="http://www.w3.org/1999/xlink" class="'+F+'-bell-icon"><use class="'+F+'-bell-path bell-prompt-fab" style="fill: '+e.textcolor+' !important;" xlink:href="#sp_bell_icon" x="0" y="0">'+u+"</use></svg>",T.setAttribute("href","#"),E.appendChild(T);var I=document.createElement("div");I.setAttribute("class",F+"-cell");var O=document.createElement("a");O.setAttribute("href","#"),O.innerHTML=g,I.appendChild(O),M.appendChild(E),M.appendChild(I);var A,N=document.createElement("div");N.setAttribute("class",F+"-prompt-label"),(A=document.createElement("a")).setAttribute("href",z),A.setAttribute("target","_blank"),(b=document.createElement("span")).innerHTML=V[s],A.appendChild(b),N.appendChild(A)}else{var k=document.createElement("div");k.setAttribute("class",F+"-prompt-fab "+F+"_notify_prompt"),k.setAttribute("onclick","oSpP.startSubscription();oSpP.showHintDiv(); return false;"),0<e.btncolor.length&&k.setAttribute("style","background-color: "+e.btncolor+" !important;"),k.innerHTML+=u+'<svg viewBox="0 0 525.153 525.153" width="40" height="40" xmlns:xlink="http://www.w3.org/1999/xlink" class="'+F+'-bell-icon" ><use class="'+F+'-bell-path bell-prompt-fab" style="fill: '+e.iconcolor+' !important;" xlink:href="#sp_bell_icon" x="0" y="0" /></svg>'}void 0!==e.custom&&void 0!==e.custom.prompt_position&&(l+=" "+F+"-fab-"+e.custom.prompt_position,p.setAttribute("class",l))}else if(i==F+"-modal"||i==F+"-safari"){var M;(M=document.createElement("div")).setAttribute("class",F+"-prompt-title "+F+"-prompt-message-text"),0<e.textcolor.length&&M.setAttribute("style","color: "+e.textcolor+" !important;"),M.innerHTML=g,(D=document.createElement("div")).setAttribute("class",F+"-prompt-info "+F+"-prompt-message-text"),0<e.textcolor.length&&D.setAttribute("style","color: "+e.textcolor+" !important;"),D.innerHTML+=S,i==F+"-safari"?(h.setAttribute("src","https://"+c+e.icon),h.setAttribute("width","64"),h.setAttribute("height","64"),d.appendChild(h)):d.innerHTML+=u+'<svg viewBox="0 0 525.153 525.153" width="40" height="40" xmlns:xlink="http://www.w3.org/1999/xlink" class="'+F+'-bell-icon"><use class="'+F+'-bell-path" style="fill: '+e.textcolor+' !important;" xlink:href="#sp_bell_icon" x="0" y="0" />  </svg>'}if(i!=F+"-fab"){var C=document.createElement("div");C.setAttribute("class",F+"-prompt-buttons");var x=document.createElement("button");x.setAttribute("class",F+"-prompt-btn "+F+"-accept-btn "+F+"_notify_prompt"),x.setAttribute("type","button"),x.setAttribute("onclick","oSpP.startSubscription();oSpP.showHintDiv();oSpP.closeCustomPrompt(false); return false;");var L=document.createElement("button");if(L.setAttribute("class",F+"-prompt-btn "+F+"-disallow-btn"),L.setAttribute("type","button"),L.setAttribute("onclick","oSpP.sendPromptStat('prompt_denied');oSpP.closeCustomPrompt(true); return false;"),x.innerHTML=e.allowbtntext,L.innerHTML=e.disallowbtntext,x.setAttribute("style","background-color:"+e.buttoncolor+" !important;border-color:"+e.buttoncolor+" !important;"),L.setAttribute("style","color:"+e.buttoncolor+" !important;"),i===F+"-native-popover"){var j=document.createElement("div");j.setAttribute("class",F+"-table-wrapper");var B=document.createElement("div");B.setAttribute("class",F+"-cell"),n&&void 0!==f&&B.appendChild(f);var U=document.createElement("div");U.setAttribute("class",F+"-cell"),U.appendChild(L);var H=document.createElement("div");H.setAttribute("class",F+"-cell"),H.appendChild(x),j.appendChild(B),j.appendChild(U),j.appendChild(H),C.appendChild(j)}else C.appendChild(L),C.appendChild(x);if(n&&i==F+"-modal"){var K=document.createElement("div");K.innerHTML="&nbsp;",C.appendChild(K)}}if(d.appendChild(M),void 0!==D&&null!=D&&i!=F+"-native-popover"&&d.appendChild(D),i!==F+"-fab"?(d.appendChild(C),n&&void 0!==f&&i!==F+"-native-popover"&&C.appendChild(f),p.appendChild(d)):void 0!==e.custom.prompt_size&&"big"===e.custom.prompt_size?(p.appendChild(d),n&&void 0!==N&&p.appendChild(N)):(n&&void 0!==f&&d.appendChild(f),p.appendChild(d),p.appendChild(k)),i!=F+"-fab"){var G=document.createElement("button");G.setAttribute("class",F+"-prompt-close"),G.setAttribute("onclick","oSpP.closeCustomPrompt(false); return false;"),G.setAttribute("style","color:"+e.textcolor+" !important;"),G.innerHTML="&times;",p.appendChild(G)}if(document.body.insertBefore(p,document.body.childNodes[0]),i==F+"-modal"){var Y=document.createElement("div");Y.setAttribute("class",F+"-prompt-backdrop"),Y.setAttribute("style","display:none;"),document.body.insertBefore(Y,document.body.childNodes[1])}setTimeout((function(){p.className+=p.className?" show-prompt":"show-prompt"}),1e3)}},this.closeCustomPrompt=function(e){oSpP.sendPromptStat("prompt_closed"),null!==document.body.querySelector("."+F+"-prompt")&&document.body.querySelector("."+F+"-prompt").remove(),oSpP.closePromptHelpText(!0),e&&oSpP.putValueToDb("SPIDs",{type:"PromptClosed",value:5})},this.showHintDiv=function(){if(Z&&"chrome"===u.name.toLowerCase()){var e=this.getPushHintDiv();e.setAttribute("class",F+"-prompt "+F+"-hint-popover show-prompt "+F+"-secure-mode"),document.body.appendChild(e)}},this.hideHintDiv=function(){document.getElementsByClassName(F+"-hint-popover").length&&document.querySelector("."+F+"-hint-popover").remove()},this.closePromptHelpText=function(e){null!==document.querySelector("."+F+"-backdrop-info")&&document.querySelector("."+F+"-backdrop-info").remove(),e&&(oSpP.sendPromptStat("prompt_closed"),oSpP.putValueToDb("SPIDs",{type:"PromptClosed",value:5}))},this.closePushLabel=function(){null!==document.querySelector("."+F+"-bottom-push-label")&&document.querySelector("."+F+"-bottom-push-label").remove(),null!==document.querySelector("."+F+"-webpush-label")&&document.querySelector("."+F+"-webpush-label").remove()},this.getMessageLang=function(e){return"ua"==(e=e.substring(0,2).toLowerCase())||"uk"==e?"ua":"ru"==e?"ru":"en"},this.storeSubscription=function(e){oSpP.log("StoreSubscription: "+e),oSpP.putValueToDb("SPIDs",{type:"SubscriptionId",value:e})},this.getPromptDelay=function(){return parseInt(G)},this.getSettingsShowByVisitNumber=function(){return parseInt(Y)},this.startDelayedSubscription=function(e){if(0<parseInt(G))var t=setInterval((function(){oSpP.getDbValue("SPIDs","PromptDelay",(function(o){void 0!==o.target.result?(new Date).getTime()>=o.target.result.value&&(clearInterval(t),e()):(clearInterval(t),e())}))}),1e3);else e()},this.getAuthEmailFromUrl=function(){var e=window.location.href,t=new RegExp("[?&]spush(=([^&#]*)|&|#|$)").exec(e);if(t&&t[2]){var o=atob(decodeURIComponent(t[2].replace(/\+/g," ")));void 0!==o&&0<o.length&&oSpP.push("email",o)}},this.getVisitsCount=function(){var e=1;oSpP.getDbValue("SPIDs","VisitsCount",(function(t){void 0===t.target.result||(e=t.target.result.value,e+=1),oSpP.putValueToDb("SPIDs",{type:"VisitsCount",value:e}),e>=oSpP.getSettingsShowByVisitNumber()&&oSpP.checkIsServiceWorkerExitsAndInitPrompt(!1)}))},this.checkIsPopUpWindow=function(){return-1===oSpP.clearDomain(window.location.href.toLowerCase()).indexOf(oSpP.clearDomain(oSpPOptions.sAppUrlShow.toLowerCase()))&&-1!==oSpP.clearDomain(window.location.href.toLowerCase()).indexOf(oSpP.clearDomain(oSpPOptions.sPushSubSomain.toLowerCase()))},this.initPrompt=function(){0<oSpP.getPromptDelay()?oSpP.getDbValue("SPIDs","PromptDelay",(function(e){void 0===e.target.result&&oSpP.putValueToDb("SPIDs",{type:"PromptDelay",value:(new Date).getTime()+1e3*oSpP.getPromptDelay()}),oSpP.start()})):oSpP.start(),oSpP.getAuthEmailFromUrl()},this.urlBase64ToUint8Array=function(e){for(var t=(e+"=".repeat((4-e.length%4)%4)).replace(/\-/g,"+").replace(/_/g,"/"),o=window.atob(t),i=new Uint8Array(o.length),r=0;r<o.length;++r)i[r]=o.charCodeAt(r);return i}}window.addEventListener("load",(function(){-1===oSpP.clearDomain(window.location.href.toLowerCase()).indexOf(oSpP.clearDomain(oSpPOptions.sAppUrlShow.toLowerCase()))&&-1!==oSpP.clearDomain(window.location.href.toLowerCase()).indexOf(oSpP.clearDomain(oSpPOptions.sPushSubSomain.toLowerCase()))?oSpP.checkIsServiceWorkerExitsAndInitPrompt(!0):1<oSpP.getSettingsShowByVisitNumber()?oSpP.getVisitsCount():oSpP.checkIsServiceWorkerExitsAndInitPrompt(!1)}));var oSpP=new oPromptPush;document.onkeyup=function(e){27===(e=e||window.event).keyCode&&oSpP.closePromptHelpText(!1)};